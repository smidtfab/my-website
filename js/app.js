require=function t(e,a,i){function s(o,r){if(!a[o]){if(!e[o]){var l="function"==typeof require&&require;if(!r&&l)return l(o,!0);if(n)return n(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var h=a[o]={exports:{}};e[o][0].call(h.exports,(function(t){return s(e[o][1][t]||t)}),h,h.exports,t,e,a,i)}return a[o].exports}for(var n="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(t,e,a){window.app=function(){window.browser=t("browser"),window.breakpoints=t("breakpoints"),window.$=window.jQuery=t("jquery"),window.md5=t("md5"),t("jquery.touch"),t("web");t("form"),t("tabs");var e={tmp:null,buildTimestamp:1661377761,instanceId:null,countries:{us:"United States",af:"Afghanistan",ax:"Aland Islands",al:"Albania",dz:"Algeria",as:"American Samoa",ad:"Andorra",ao:"Angola",ai:"Anguilla",aq:"Antarctica",ag:"Antigua And Barbuda",ar:"Argentina",am:"Armenia",aw:"Aruba",au:"Australia",at:"Austria",az:"Azerbaijan",bs:"Bahamas",bh:"Bahrain",bd:"Bangladesh",bb:"Barbados",by:"Belarus",be:"Belgium",bz:"Belize",bj:"Benin",bm:"Bermuda",bt:"Bhutan",bo:"Bolivia",bq:"Bonaire",ba:"Bosnia And Herzegovina",bw:"Botswana",bv:"Bouvetisland",br:"Brazil",io:"British Indian Ocean Territory",bn:"Brunei Darussalam",bg:"Bulgaria",bf:"Burkina Faso",bi:"Burundi",kh:"Cambodia",cm:"Cameroon",ca:"Canada",cv:"Capeverde",ky:"Cayman Islands",cf:"Central African Republic",td:"Chad",cl:"Chile",cn:"China",cx:"Christmas Island",cc:"Cocos (Keeling) Islands",co:"Colombia",km:"Comoros",cg:"Congo",cd:"Congo",ck:"Cook Islands",cr:"Costarica",ci:"Cote D'Ivoire",hr:"Croatia",cu:"Cuba",cw:"Curacao",cy:"Cyprus",cz:"Czech Republic",dk:"Denmark",dj:"Djibouti",dm:"Dominica",do:"Dominican Republic",ec:"Ecuador",eg:"Egypt",sv:"El Salvador",gq:"Equatorial Guinea",er:"Eritrea",ee:"Estonia",et:"Ethiopia",fk:"Falkland Islands (Malvinas)",fo:"Faroe Islands",fj:"Fiji",fi:"Finland",fr:"France",gf:"French Guiana",pf:"French Polynesia",tf:"French Southern Territories",ga:"Gabon",gm:"Gambia",ge:"Georgia",de:"Germany",gh:"Ghana",gi:"Gibraltar",gr:"Greece",gl:"Greenland",gd:"Grenada",gp:"Guadeloupe",gu:"Guam",gt:"Guatemala",gg:"Guernsey",gn:"Guinea",gw:"Guinea-Bissau",gy:"Guyana",ht:"Haiti",hm:"Heard Island And Mcdonald Islands",va:"Vatican City State",hn:"Honduras",hk:"Hongkong",hu:"Hungary",is:"Iceland",in:"India",id:"Indonesia",ir:"Iran",iq:"Iraq",ie:"Ireland",im:"Isleofman",il:"Israel",it:"Italy",jm:"Jamaica",jp:"Japan",je:"Jersey",jo:"Jordan",kz:"Kazakhstan",ke:"Kenya",ki:"Kiribati",kp:"Democratic People's Republic Of Korea",kr:"Republic Of Korea",kw:"Kuwait",kg:"Kyrgyzstan",la:"Lao People's Democratic Republic",lv:"Latvia",lb:"Lebanon",ls:"Lesotho",lr:"Liberia",ly:"Libyan Arab Jamahiriya",li:"Liechtenstein",lt:"Lithuania",lu:"Luxembourg",mo:"Macao",mk:"Macedonia",mg:"Madagascar",mw:"Malawi",my:"Malaysia",mv:"Maldives",ml:"Mali",mt:"Malta",mh:"Marshall Islands",mq:"Martinique",mr:"Mauritania",mu:"Mauritius",yt:"Mayotte",mx:"Mexico",fm:"Micronesia",md:"Moldova",mc:"Monaco",mn:"Mongolia",me:"Montenegro",ms:"Montserrat",ma:"Morocco",mz:"Mozambique",mm:"Myanmar",na:"Namibia",nr:"Nauru",np:"Nepal",nl:"Netherlands",nc:"New Caledonia",nz:"New Zealand",ni:"Nicaragua",ne:"Niger",ng:"Nigeria",nu:"Niue",nf:"Norfolk Island",mp:"Northern Mariana Islands",no:"Norway",om:"Oman",pk:"Pakistan",pw:"Palau",ps:"Palestinian Territory",pa:"Panama",pg:"Papuanewguinea",py:"Paraguay",pe:"Peru",ph:"Philippines",pn:"Pitcairn",pl:"Poland",pt:"Portugal",pr:"Puertorico",qa:"Qatar",re:"Reunion",ro:"Romania",ru:"Russia",rw:"Rwanda",bl:"Saint Barthelemy",sh:"Saint Helena",kn:"Saint Kitts And Nevis",lc:"Saint Lucia",mf:"Saint Martin",pm:"Saint Pierre And Miquelon",vc:"Saint Vincent And The Grenadines",ws:"Samoa",sm:"Sanmarino",st:"Saotome And Principe",sa:"Saudi Arabia",sn:"Senegal",rs:"Serbia",sc:"Seychelles",sl:"Sierraleone",sg:"Singapore",sx:"Sintmaarten",sk:"Slovakia",si:"Slovenia",sb:"Solomon Islands",so:"Somalia",za:"South Africa",gs:"South Georgia And The South Sandwich Islands",es:"Spain",lk:"Srilanka",sd:"Sudan",sr:"Suriname",sj:"Svalbard And Jan Mayen",sz:"Swaziland",se:"Sweden",ch:"Switzerland",sy:"Syrian Arab Republic",tw:"Taiwan",tj:"Tajikistan",tz:"Tanzania",th:"Thailand",tl:"Timor-Leste",tg:"Togo",tk:"Tokelau",to:"Tonga",tt:"Trinidad And Tobago",tn:"Tunisia",tr:"Turkey",tm:"Turkmenistan",tc:"Turks And Caicos Islands",tv:"Tuvalu",ug:"Uganda",ua:"Ukraine",ae:"United Arab Emirates",gb:"United Kingdom",um:"United States Minor Outlying Islands",uy:"Uruguay",uz:"Uzbekistan",vu:"Vanuatu",ve:"Venezuela",vn:"Vietnam",vg:"British Virgin Islands",vi:"Us Virgin Islands",wf:"Wallis And Futuna",eh:"Western Sahara",ye:"Yemen",zm:"Zambia",zw:"Zimbabwe"},languages:{ab:"Abkhazian",aa:"Afar",af:"Afrikaans",ak:"Akan",sq:"Albanian",am:"Amharic",ar:"Arabic",an:"Aragonese",hy:"Armenian",as:"Assamese",av:"Avaric",ae:"Avestan",ay:"Aymara",az:"Azerbaijani",bm:"Bambara",ba:"Bashkir",eu:"Basque",be:"Belarusian",bn:"Bengali",bh:"Bihari languages",bi:"Bislama",nb:"Bokmål, Norwegian",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",km:"Central Khmer",ch:"Chamorro",ce:"Chechen",ny:"Chichewa",zh:"Chinese",cu:"Church Slavic",cv:"Chuvash",kw:"Cornish",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",dv:"Divehi",nl:"Dutch",dz:"Dzongkha",en:"English",eo:"Esperanto",et:"Estonian",ee:"Ewe",fo:"Faroese",fj:"Fijian",fi:"Finnish",fr:"French",ff:"Fulah",gd:"Gaelic",gl:"Galician",lg:"Ganda",ka:"Georgian",de:"German",el:"Greek",gn:"Guarani",gu:"Gujarati",ht:"Haitian",ha:"Hausa",he:"Hebrew",hz:"Herero",hi:"Hindi",ho:"Hiri Motu",hu:"Hungarian",is:"Icelandic",io:"Ido",ig:"Igbo",id:"Indonesian",ia:"Interlingua",ie:"Interlingue",iu:"Inuktitut",ik:"Inupiaq",ga:"Irish",it:"Italian",ja:"Japanese",jv:"Javanese",kl:"Kalaallisut",kn:"Kannada",kr:"Kanuri",ks:"Kashmiri",kk:"Kazakh",ki:"Kikuyu",rw:"Kinyarwanda",ky:"Kirghiz",kv:"Komi",kg:"Kongo",ko:"Korean",kj:"Kuanyama",ku:"Kurdish",lo:"Lao",la:"Latin",lv:"Latvian",li:"Limburgan",ln:"Lingala",lt:"Lithuanian",lu:"Luba-Katanga",lb:"Luxembourgish",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",gv:"Manx",mi:"Maori",mr:"Marathi",mh:"Marshallese",mn:"Mongolian",na:"Nauru",nv:"Navajo",nd:"Ndebele, North",nr:"Ndebele, South",ng:"Ndonga",ne:"Nepali",se:"Northern Sami",no:"Norwegian",nn:"Norwegian Nynorsk",oc:"Occitan",oj:"Ojibwa",or:"Oriya",om:"Oromo",os:"Ossetian",pi:"Pali",pa:"Panjabi",fa:"Persian",pl:"Polish",pt:"Portuguese","pt-br":"Portuguese, Brazilian",ps:"Pushto",qu:"Quechua",ro:"Romanian",rm:"Romansh",rn:"Rundi",ru:"Russian",sm:"Samoan",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sr:"Serbian",sn:"Shona",ii:"Sichuan Yi",sd:"Sindhi",si:"Sinhala",sk:"Slovak",sl:"Slovenian",so:"Somali",st:"Sotho, Southern",es:"Spanish",su:"Sundanese",sw:"Swahili",ss:"Swati",sv:"Swedish",tl:"Tagalog",ty:"Tahitian",tg:"Tajik",ta:"Tamil",tt:"Tatar",te:"Telugu",th:"Thai",bo:"Tibetan",ti:"Tigrinya",to:"Tonga",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",tw:"Twi",ug:"Uighur",uk:"Ukrainian",ur:"Urdu",uz:"Uzbek",ve:"Venda",vi:"Vietnamese",vo:"Volapük",wa:"Walloon",cy:"Welsh",fy:"Western Frisian",wo:"Wolof",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",za:"Zhuang",zu:"Zulu"},touch:{useTouch:!0,useMouse:!0,dragStartEvents:"dragStart tapAndHold",dragPreventDefault:!1,scrollbars:!0},flags:{lsdUnits:!1},registry:{get:function(t){return localStorage.getItem(t)},set:function(t,e){return localStorage.setItem(t,e)},unset:function(t){return localStorage.removeItem(t)},exists:function(t){return null!==localStorage.getItem(t)},watch:function(t){window.addEventListener("storage",t)}},temp:{get:function(t){return sessionStorage.getItem(t)},set:function(t,e){return sessionStorage.setItem(t,e)},unset:function(t){return sessionStorage.removeItem(t)},exists:function(t){return null!==sessionStorage.getItem(t)}},flag:{has:function(t,e){return web.bit.has(t,e)},set:function(t,e){return web.bit.on(t,e)},unset:function(t,e){return web.bit.off(t,e)}},rootCSS:{setVar:function(t,e){document.documentElement.style.setProperty("--"+t,e)},unsetVar:function(t){document.documentElement.style.setProperty("--"+t,null)}},dialog:{$wrapper:null,$inner:null,$content:null,$actions:null,$notice:null,timeoutId:null,init:function(){var t=this;this.$wrapper=$('<div id="dialog" class="modal" tabindex="-1"><section class="inner"><div class="content"></div><ul class="actions special"></ul><p class="notice"></p><span class="close do-close"><svg><use xlink:href="#icon-cancel"></use></svg></span></section></div>').on("mousedown",(function(e){e.preventDefault(),e.stopPropagation(),t.isLocked()||t.inPreshow()||t.hide()})).on("click mousedown",".inner",(function(t){t.stopPropagation()})).on("click",".do-close",(function(e){e.preventDefault(),e.stopPropagation(),t.isLocked()||t.hide()})).on("keydown",(function(e){if(!t.isLocked())switch(e.keyCode){case 13:if(t.inPreshow())return;t.$actions.find("li > span").first().not(".disabled").trigger("click");break;case 27:if(t.inPreshow())return;t.hide()}})),this.$inner=this.$wrapper.find(".inner"),this.$content=this.$wrapper.find(".content"),this.$actions=this.$wrapper.find(".actions"),this.$notice=this.$wrapper.find(".notice")},show:function(t){var a,i,s=this,n=0;for(this.$wrapper.appendTo(e.$body),a=$.extend({content:null,title:"Alert",message:"Something happened apparently.",html:!1,class:null,dockable:!1,confirmation:!1,error:!1,actions:{Okay:function(){this.hide()}},notice:null,noticeType:"none",show:null,delay:100},t),this.$content.children().remove(),a.content?this.$content.html(a.content):(a.title&&this.$content.append('<h2 class="title">'+a.title+"</h2>"),a.message&&this.$content.append('<div class="message">'+(a.html?a.message:"<p>"+a.message+"</p>")+"</div>")),null===a.notice?this.$notice.hide():this.$notice.attr("data-type",a.noticeType).show().html(a.notice),this.$actions.children().remove(),null===a.actions?this.$actions.hide():(this.$actions.show(),n=0,$.each(a.actions,(function(t,e){$('<li><span class="button'+(0==n++?a.error?" error":" special":"")+(!1===e?" disabled":"")+'">'+t+"</span></li>").appendTo(s.$actions).on("click",".button",(function(t){var a=$(this);t.preventDefault(),t.stopPropagation(),a.hasClass("disabled")||e.apply(s)}))}))),a.confirmation&&(s.$actions.find("li > span").first().addClass("disabled"),this.$content.append('<div class="confirmation"><input type="checkbox" id="dialog-confirmation" /><label for="dialog-confirmation">'+a.confirmation+"</label></div>"),this.$content.find('input[type="checkbox"]').on("change",(function(){var t=$(this),e=s.$actions.find("li > span").first();t.prop("checked")?e.removeClass("disabled"):e.addClass("disabled")}))),a.show&&a.show.apply(this),i=this.$wrapper[0].classList,n=0;n<i.length;n++)"modal"!=i[n]&&"preshow"!=i[n]&&"visible"!=i[n]&&this.$wrapper.removeClass(i[n]);a.class&&this.$wrapper.addClass(a.class),a.dockable&&(e.$body.css("overflow","hidden"),e.$window.on("resize.dialog",(function(){clearTimeout(s.timeoutId),s.timeoutId=setTimeout((function(){var t=e.$window.height(),a=s.$inner.height();s.$wrapper.hasClass("docked")?t>a&&s.$wrapper.removeClass("docked"):t<a&&s.$wrapper.addClass("docked")}),25)})).trigger("resize.dialog")),window.setTimeout((function(){s.$wrapper.removeClass("preshow"),s.$wrapper.addClass("visible"),window.setTimeout((function(){s.$wrapper.focus()}),150)}),a.delay)},hide:function(){var t=this;this.$wrapper.removeClass("visible"),window.setTimeout((function(){t.$content.children().remove(),t.$notice.html(""),t.$actions.children().remove(),e.$body.css("overflow",""),e.$window.off("resize.dialog"),clearTimeout(t.timeoutId)}),125)},preshow:function(t){var a=this;this.$wrapper.appendTo(e.$body),this.$wrapper.addClass("preshow"),t?this.$wrapper.removeClass("with-spinner"):this.$wrapper.addClass("with-spinner"),window.setTimeout((function(){a.$wrapper.addClass("visible")}),100),window.setTimeout((function(){a.$wrapper.focus()}),250)},inPreshow:function(){return this.$wrapper.hasClass("preshow")},isLocked:function(){return this.$wrapper.hasClass("locked")}},progressOverlay:{$wrapper:null,$progress:null,$status:null,options:null,autoIntervalId:null,autoProgressHandler:null,autoStatusHandler:null,init:function(){this.$wrapper=$('<div id="progress-overlay" tabindex="-1"><div class="progress"></div><div class="status"></div></div>'),this.$progress=this.$wrapper.find(".progress"),this.$status=this.$wrapper.find(".status")},show:function(t){var a,s=this;for(0==this.$wrapper.parent().length&&this.$wrapper.appendTo(e.$body),this.options=$.extend({class:null,scrollLock:!1},t),this.$progress.attr("data-value","0"),this.$status.text(""),a=this.$wrapper[0].classList,i=0;i<a.length;i++)"visible"!=a[i]&&this.$wrapper.removeClass(a[i]);this.options.class&&this.$wrapper.addClass(this.options.class),s.$wrapper.addClass("visible"),this.options.scrollLock&&e.$body.css("overflow","hidden"),window.setTimeout((function(){s.$wrapper.focus()}),100),window.setTimeout((function(){s.$wrapper.addClass("active")}),250)},hide:function(){var t=this;this.autoIntervalId&&(clearInterval(this.autoIntervalId),this.progress(this.autoProgressHandler(100),this.autoStatusHandler?this.autoStatusHandler(100):void 0)),t.$wrapper.removeClass("active"),setTimeout((function(){t.$progress.attr("data-value","0"),t.$status.text(""),t.$wrapper.removeClass("visible"),t.options.scrollLock&&e.$body.css("overflow",""),t.options=null}),250)},progress:function(t,e,a){if(void 0===t)return parseInt(this.$progress.attr("data-value"));this.$progress.attr("data-value",t),void 0!==e&&this.status(e,a)},status:function(t){this.$status.text(t)},auto:function(t,e,a,i){var s=this;this.autoProgressHandler=a,this.autoStatusHandler=i,this.autoIntervalId=setInterval((function(){var e;e=Math.min(98,s.progress()+t),s.progress(s.autoProgressHandler(e),s.autoStatusHandler?s.autoStatusHandler(e):void 0)}),e)}},$window:null,$document:null,$head:null,$body:null,$html:null,URL_PLACEHOLDER:"https://domain.ext/path",dataUrl:{is:function(t){return"string"==typeof t&&!!t.match(/^data:/)},createFromUrl:function(t,e){var a;(a=new XMLHttpRequest).open("GET",t,!0),a.responseType="blob",a.onload=function(t){var a;(a=new FileReader).onloadend=function(){e(a.result)},a.readAsDataURL(this.response)},a.send()}},objectUrl:{list:{},is:function(t){return"string"==typeof t&&!!t.match(/^blob:/)},get:function(t){return t in this.list?this.list[t]:null},create:function(t){var e;return e=void 0!==window.webkitURL?window.webkitURL.createObjectURL(t):void 0!==window.URL?window.URL.createObjectURL(t):null,this.list[e]=t,e},revoke:function(t){void 0!==window.webkitURL?window.webkitURL.revokeObjectURL(t):void 0!==window.URL&&window.URL.revokeObjectURL(t),t in this.list&&delete this.list[t]},clone:function(t){var e=this.get(t);return app.objectUrl.create(e.slice())},createFromUrl:function(t,e){var a,i=this;(a=new XMLHttpRequest).open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(t){var s;s=i.create(new Blob([new Uint8Array(this.response)],{type:a.getResponseHeader("content-type")})),e(s)},a.send()}},user:{TRIAL_SOURCE_OTHER:1,TRIAL_SOURCE_DASHBOARD:2,TRIAL_SOURCE_DASHBOARD_DIALOG:3,TRIAL_SOURCE_TEMPLATE_DIALOG:4,TRIAL_SOURCE_BUILDER_DIALOG:5,loggedIn:!1,gtoken:null,hash:null,isLoggedIn:function(){return!0===this.loggedIn},isNew:function(){return!this.isLoggedIn()},init:function(t){this.loggedIn=t.loggedIn,this.gtoken=t.gtoken,this.hash=t.hash,app.globalEvents.trigger("user.init",t)},sync:function(t){return this.loggedIn!=t.loggedIn&&(this.loggedIn=t.loggedIn,this.gtoken=t.gtoken,this.hash=t.hash,!0)}},globalEvents:{events:{},channel:null,init:function(){var t=this;"BroadcastChannel"in window?(this.channel=new BroadcastChannel("default"),this.channel.onmessage=function(e){t.handle(e.data)}):app.registry.watch((function(){var e,a,i,s;for(e in t.events)a="globalEvent."+e,app.registry.exists(a)&&(i=app.registry.get(a),s=JSON.parse(i),t.handle(s))}))},on:function(t,e){t in this.events||(this.events[t]=[]),this.events[t].push({handler:e,timestamp:0})},handle:function(t){var a,i;if(t.instanceId!=e.instanceId&&t.event in this.events)for(a in this.events[t.event])i=this.events[t.event][a],t.timestamp>i.timestamp&&(i.timestamp=t.timestamp,i.handler(t.args))},trigger:function(t,a){var i,s;i={timestamp:Date.now(),instanceId:e.instanceId,event:t,args:a},this.channel?this.channel.postMessage(i):(s="globalEvent."+t,app.registry.set(s,JSON.stringify(i)))}},plan:{PERK_PREMIUM_NAMES:1,PERK_CUSTOM_DOMAINS:2,PERK_NO_CREDITS:3,PERK_FORM_COMPONENTS:4,PERK_ADVANCED_FORM_COMPONENTS:5,PERK_DOWNLOAD_SITES:6,PERK_TRANSFER_SITES:7,PERK_SHARE_SITES:8,PERK_PRO_TEMPLATES:9,PERK_WIDGET_COMPONENTS:10,PERK_EMBED_COMPONENTS:11,PERK_HIGH_QUALITY_ASSETS:12,PERK_LARGER_ASSETS:13,PERK_FAVICONS:14,PERK_OPENGRAPH:15,PERK_TRACKING:16,PERK_MORE_COMPONENTS:17,PERK_MORE_COMPONENTS_100:18,PERK_META:19,PERK_REDIRECTS:20,PERK_PASSWORD:21,PERK_ADVANCED_SETTINGS:22,PERK_EXPERIMENTAL:23,PERK_TEMPLATE_MODE:24,PERK_VIDEO_UPLOAD_COMPONENTS:25,PERK_SLIDESHOW_COMPONENTS:26,PERK_TEXT_FILES:27,PERK_ADVANCED_TEMPLATE_MODE:28,PERK_VARIABLES:29,PERK_UPDATE_FREQUENCY:1001,PERK_MULTIPLE_SITES:1002,PERK_MULTIPLE_SITES_25:1003,PERK_MULTIPLE_SITES_50:1004,PERK_MULTIPLE_SITES_100:1005,PERK_MULTIPLE_SITES_250:1006,PERK_MULTIPLE_SITES_500:1007,PERK_UNLIMITED_SITES:1008,ID_BASIC:1,ID_TRIAL:2,id:1,lastId:null,perks:[],trialPerks:[],trialUsed:!1,startTrialHandler:null,messages:{upgrade:"Available with upgrade – click to learn more!",full:"Available with Pro – click to learn more!",trial:"Try free for 7 days – click to learn more!"},perkToKey:function(t){return"#"+t},keyToPerk:function(t){return parseInt(t.substr(1))},init:function(t){this.id=t.id,this.perks=t.perks,this.trialPerks=t.trialPerks,this.trialUsed=t.trialUsed,app.globalEvents.trigger("plan.init",t)},sync:function(t){return t.id!=this.id&&(this.id=t.id,this.perks=t.perks,this.trialPerks=t.trialPerks,this.trialUsed=t.trialUsed,!0)},dependencies:{},canStartTrial:function(){return!1===this.trialUsed},hasPerk:function(t){return-1!==this.perks.indexOf(t)},addDependency:function(t){var e,a=this;e=this.perkToKey(t.perk),t.enabled=!0,e in this.dependencies||(this.dependencies[e]=[]),this.dependencies[e].push(t),"watch"in t&&t.watch.on("change",(function(){var e="function"==typeof t.target?t.target():t.target;t.enabled?e.each((function(){t.enable.apply($(this))})):e.each((function(){t.disable.apply($(this),[function(e){e.preventDefault(),e.stopPropagation(),a.dependencyDialog(t.perk)(t.action)},a.dependencyMessage(t.perk)])}))}))},enableDependencies:function(t){var e,a,i;for(e in i=this.perkToKey(t),this.dependencies[i])(a=this.dependencies[i][e]).enabled||(a.enable.apply("function"==typeof a.target?a.target():a.target),a.enabled=!0)},disableDependencies:function(t){var e,a,i,s=this;for(e in i=this.perkToKey(t),this.dependencies[i])(a=this.dependencies[i][e]).enabled&&(a.disable.apply("function"==typeof a.target?a.target():a.target,[function(e){e.preventDefault(),e.stopPropagation(),s.dependencyDialog(t)(a.action)},s.dependencyMessage(t)]),a.enabled=!1)},refresh:function(){var t,e;for(t in this.dependencies)e=this.keyToPerk(t),this.hasPerk(e)?this.enableDependencies(e):this.disableDependencies(e)},dependencyDialog:function(t){return-1!=this.trialPerks.indexOf(t)&&this.canStartTrial()?this.trialDialog:this.id==this.ID_BASIC||this.id==this.ID_TRIAL?this.fullDialog:this.upgradeDialog},dependencyMessage:function(t){return-1!=this.trialPerks.indexOf(t)&&this.canStartTrial()?this.messages.trial:this.id==this.ID_BASIC||this.id==this.ID_TRIAL?this.messages.full:this.messages.upgrade},upgradeDialog:function(){e.dialog.show({title:"Available with Upgrade",message:"Get access to this feature by upgrading your Pro plan.",actions:{"Learn More":function(){this.hide(),window.open(e.user.isLoggedIn()?"/dashboard/account/plan/change":"/pro")},"Maybe Later":function(){this.hide()}}})},fullDialog:function(){e.dialog.show({title:"Available with Pro",message:"Access this feature by upgrading to a full Pro plan from just <strong>$19 / year</strong>.",actions:{"Learn More":function(){this.hide(),window.open(e.user.isLoggedIn()?"/dashboard/account/plan/change":"/pro")},"Maybe Later":function(){this.hide()}}})},trialDialog:function(t,a,i){var s={};a||(a="Start Free Trial"),i||(i="Test drive this"),s[a]=function(){this.hide(),e.plan.startTrialHandler(t)},s["Learn More"]=function(){this.hide(),window.open(e.user.isLoggedIn()?"/dashboard/account/plan/change":"/pro")},s["Maybe Later"]=function(){this.hide()},e.dialog.show({class:"pro",dockable:!0,content:"<header><h2>Try Pro!</h2><p>"+i+' and other top Pro features free for <strong>7 days</strong> &ndash; no credit card required! Upgrade to a full Pro plan any time from just <strong>$19 / year</strong>.</p></header><ul class="pro-features"><li><h3>Custom Domains</h3><p>Publish sites to any custom domains you own with <a href="/docs/sites/setting-up-ssl" target="_blank">full SSL support via Let\'s Encrypt</a>.</p></li><li><h3>Forms</h3><p>Add fully functional <a href="/docs/forms/setting-up-a-contact-form" target="_blank">contact forms</a>, <a href="/docs/forms/setting-up-a-signup-form" target="_blank">signup forms</a>, or build your own custom forms.</p></li><li><h3>Widgets</h3><p>Embed third-party widgets from <a href="/docs/building/adding-a-stripe-checkout-button" target="_blank">Stripe</a>, <a href="/docs/building/adding-a-paypal-button" target="_blank">PayPal</a>, <a href="/docs/building/adding-a-gumroad-buy-button" target="_blank">Gumroad</a>, <a href="/docs/building/adding-a-typeform" target="_blank">Typeform</a>, and more.</p></li><li><h3>High Quality Images</h3><p>Publish sites with bigger, higher quality images and backgrounds.</p></li><li><h3>Video Uploads</h3><p>Upload and use your own <a href="/docs/building/adding-videos" target="_blank">videos</a> throughout your site (or as its <a href="/docs/building/setting-a-background-video" target="_blank">background</a>).</p></li><li><h3>Slideshows</h3><p>Create fully animated slideshows as <a href="/docs/building/setting-a-background-slideshow" target="_blank">backgrounds</a> or standalone elements.</p></li><li><h3>No Branding</h3><p>Publish sites to unbranded URLs (like .crd.co) and without the "Made with Carrd" branding.</p></li><li><h3>Pro Templates</h3><p>Access premium starting point templates exclusive to all Pro users.</p></li><li><h3>And more ...</h3><p><a href="/docs/sites/setting-up-google-analytics" target="_blank">Google Analytics</a>, customizable <a href="/docs/sites/adding-a-site-icon" target="_blank">site icons</a>, editable <a href="/docs/sites/setting-up-meta-tags" target="_blank">meta tags</a>, and <a href="/docs/pro/trial" target="_blank">more</a>.</p></li></ul>',actions:s})}},round:function(t,e){var a="number"==typeof e?Math.pow(10,e):1;return Math.round(t*a)/a},markdownify:function(t){var e,a,i;if((a=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=web.escapeHTML(t)).replace(/\\_/g,"%5F")).replace(/\\\*/g,"%2A")).replace(/\\~/g,"%7E")).replace(/\\`/g,"%80")).replace(/\\=/g,"%3D")).replace(/\\-/g,"%2D")).replace(/\\\^/g,"%5E")).replace(/\\\(/g,"%28")).replace(/\\\)/g,"%29")).replace(/\\\[/g,"%5B")).replace(/\\\]/g,"%5D")).replace(/\\\{/g,"%7B")).replace(/\\\}/g,"%7D")).match(/\[([^\]]+?)\]\(([^\s\)]+?)\)/g))&&a.length>0)for(i in a)t=t.replace(a[i],a[i].replace(/_/g,"%5F"));if((a=t.match(/\{\{[^\}]+\}\}/g))&&a.length>0)for(i in a)t=t.replace(a[i],a[i].replace(/_/g,"%5F"));return e=(t=(t=t.replace(/\\\\n/g,"%5Cn")).replace(/\\n/g,"%0A")).match(/\[[^\[\]]+?\]\{[^\s\}]+?\}/g),Array.isArray(e)&&e.forEach((function(e){(e.match(/\[[^\[\]]+?\]\{[a-zA-Z]+?\}/g)||e.match(/\[[^\[\]]+?\]\{#[a-fA-F0-9]{6}?\}/g))&&(t=t.replace(e,e.replace(/\[([^\[\]]+?)\]\{([^\s\}]+?)\}/g,'<span style%3D"color: $2">$1</span>')))})),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\[([^\[\]]+?)\]\(([^\s\)]+?)\)/g,'<span class%3D"--a" data-href%3D"$2">$1</span>')).replace(/__([^_]+?)__/g,'<span class%3D"--u">$1</span>')).replace(/\*\*\*([^\*]+?)\*\*\*/g,'<span class%3D"--strong"><span class%3D"--em">$1</span></span>')).replace(/\*\*([^\*]+?)\*\*/g,'<span class%3D"--strong">$1</span>')).replace(/\*([^\*]+?)\*/g,'<span class%3D"--em">$1</span>')).replace(/_([^_]+?)_/g,'<span class%3D"--em">$1</span>')).replace(/`([^`]+?)`/g,'<span class%3D"--code">$1</span>')).replace(/~~([^~]+?)~~/g,'<span class%3D"--s">$1</span>')).replace(/==([^=]+?)==/g,'<span class%3D"--mark">$1</span>')).replace(/~([^~]+?)~/g,'<span class%3D"--sub">$1</span>')).replace(/\^([^\^]+?)\^/g,'<span class%3D"--sup">$1</span>')).replace(/%5F/g,"_")).replace(/%2A/g,"*")).replace(/%7E/g,"~")).replace(/%80/g,"`")).replace(/%3D/g,"=")).replace(/%2D/g,"-")).replace(/%5E/g,"^")).replace(/%28/g,"(")).replace(/%29/g,")")).replace(/%5B/g,"[")).replace(/%5D/g,"]")).replace(/%7B/g,"{")).replace(/%7D/g,"}")).replace(/%5F/g,"_")).replace(/%5Cn/g,"\\n")).replace(/%0A/g,"<br />")},hasMarkdown:function(t,e){switch(t){case"link":return!!e.match(/\[(.+?)\]\(([^\[\]]+?)\)/g);case"bold":return!!e.match(/\*\*([^\*]+?)\*\*/g)||!!e.match(/__([^_]+?)__/g);case"italic":return!!e.match(/\*([^\*]+?)\*/g)||!!e.match(/_([^_]+?)_/g);case"code":return!!e.match(/`([^`]+?)`/g);case"strike":return!!e.match(/~~([^~]+?)~~/g);case"highlight":return!!e.match(/==([^=]+?)==/g)}return!1},transparentize:function(t,e){var a,i;return 1==e||"#"!=t.charAt(0)||7!=t.length&&9!=t.length?t:(0==e&&(e=.01),a=t.substr(0,7),i=9==t.length?parseInt(t.substr(7,2),16):255,1==(i=parseInt(i*e).toString(16)).length&&(i="0"+i),(a+i).toUpperCase())},htmlaToHtml:function(t){return 9==t.length?t.substr(0,7):t},htmlToMatrixValues:function(t){var e;for(i in"#"==t.charAt(0)&&(t=t.substr(1)),e=[t.substr(0,2),t.substr(2,2),t.substr(4,2),t.substr(6,2)])e[i]=""!==e[i]?parseInt(e[i],16)/256:1;return e[0]+" 0 0 0 0 0 "+e[1]+" 0 0 0 0 0 "+e[2]+" 0 0 0 0 0 "+e[3]+" 0"},htmlTorgb:function(t,e){var a,i;if("string"!=typeof t)return"rgba(0,0,0,"+(void 0!==e?e:"")+")";for(i in"#"==t.charAt(0)&&(t=t.substr(1)),a=[t.substr(0,2),t.substr(2,2),t.substr(4,2)])a[i]=parseInt(a[i],16);return a=a.join(","),void 0!==e?"rgba("+a+","+e+")":"rgb("+a+")"},isTranslucent:function(t){return"#"==t.charAt(0)&&(9==t.length&&"FF"!=t.substr(7,2).toUpperCase())},CSSPositionValue:function(t){var e;switch(t){case"top-left":e="top left";break;case"top":e="top";break;case"top-right":e="top right";break;case"right":e="right";break;case"bottom-right":e="bottom right";break;case"bottom":e="bottom";break;case"bottom-left":e="bottom left";break;case"left":e="left";break;default:e="center"}return e},CSSRepeatValue:function(t){var e;switch(t){case"horizontal":e="repeat-x";break;case"vertical":e="repeat-y";break;case"both":e="repeat";break;default:e="no-repeat"}return e},CSSSizeValue:function(t,e){var a;switch(t){case"stretch":a="100% 100%";break;case"fit":a="contain";break;case"fill":a="cover";break;case"custom":a=e+"rem";break;default:a="auto"}return a},cleanHref:function(){var t=window.location.href;return-1!==t.indexOf("?")&&(t=t.split("?")[0]),-1!==t.indexOf("#")&&(t=t.split("#")[0]),t},cleanBaseHref:function(){return window.location.protocol+"//"+window.location.hostname},isRTLLanguage:function(t){switch(t){case"ar":case"arc":case"dv":case"fa":case"ha":case"he":case"khw":case"ks":case"ku":case"ps":case"ur":case"yi":return!0}return!1},normalizeWheel:function(t){var e=0,a=0,i=0,s=0;return"detail"in t?a=t.detail:"wheelDelta"in t?a=t.wheelDelta/-120:"wheelDeltaY"in t&&(a=t.wheelDeltaY/-120),"wheelDeltaX"in t&&(e=t.wheelDeltaX/-120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=a,a=0),i=10*e,s=10*a,"deltaY"in t&&(s=t.deltaY),"deltaX"in t&&(i=t.deltaX),(i||s)&&t.deltaMode&&(1==t.deltaMode?(i*=40,s*=40):(i*=800,s*=800)),i&&!e&&(e=i<1?-1:1),s&&!a&&(a=s<1?-1:1),{spinX:e,spinY:a,pixelX:i,pixelY:s}},scrollify:function(t,a){var i,s=$.extend({middle:!1,replay:!1,delay:0,offset:0,duration:0,onPlay:null},a);s.replay&&t.on("click",(function(e){e.preventDefault(),e.stopPropagation(),t.hasClass("played")&&(t.removeClass("played").removeClass("active").removeClass("paused"),setTimeout((function(){t.addClass("active"),s.onPlay&&s.onPlay(t),setTimeout((function(){t.addClass("played")}),s.duration)}),250))})),e.$window.on("scroll",(function(e){var a,n=$(document).scrollTop(),o=window.innerHeight,r=t.offset().top,l=t.offset().top+t.outerHeight();t.hasClass("active")?t.hasClass("paused")?l>n&&r<n+o&&t.removeClass("paused"):(l<n||r>n+o)&&t.addClass("paused"):(s.middle?(a=n+o/2,result=a>r&&a<l):result=l>n&&r<n+o,result?(clearTimeout(i),i=setTimeout((function(){t.addClass("active"),s.onPlay&&s.onPlay(t),s.replay&&setTimeout((function(){t.addClass("played")}),s.duration)}),s.delay)):clearTimeout(i))})).triggerHandler("scroll")},scrollTo:function(t){var a,i,s,n,o,r,l,c,h,d,p=$.extend({$context:null,$target:null,callback:null,offset:0,center:!1,duration:750,nested:!1},t);setTimeout((function(){p.$context?(a=p.$context,d=p.$target.position().top,p.nested&&p.$target.parents().each((function(){var t=$(this);if(t[0]===a[0])return!1;d+=Math.max(0,t.position().top)})),i=a.scrollTop(),s=Math.max(0,d+p.offset+(p.center?p.$target.outerHeight()/2:0)),n=Math.abs(i-s),o=Math.max(250,Math.min(p.duration,p.duration*(n/(a.innerHeight()/2)))),s=Math.min(Math.floor(s),a.prop("scrollHeight")-a.innerHeight())):(a=$("body,html"),d=p.$target.offset().top,i=a.scrollTop(),s=Math.max(0,d+p.offset-(e.$window.height()-(p.center?p.$target.outerHeight():0))/2),n=Math.abs(i-s),o=Math.max(250,Math.min(p.duration,p.duration*(n/(e.$window.height()/2)))),s=Math.floor(s)),r=Date.now(),c=s-i,l=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},(h=function(){var t=Date.now()-r,e=a[0].scrollTop;p.callback&&e>=s-1&&e<=s+1&&setTimeout((function(){p.callback()}),25),t>=o?a[0].scroll(0,s):(a[0].scroll(0,i+c*l(t/o)),requestAnimationFrame(h))})()}),0)},splitCSSStyles:function(t){var e,a,i,s={},n=["margin","margin-top","margin-bottom"];if(0==(e=t.split("\n")).length)return{};for(i=0;i<e.length;i++)2===(a=e[i].split(":")).length&&(a[0]=a[0].trim(),a[1]=a[1].trim(),web.is("id",a[0])&&";"==a[1].substr(-1)&&(s[a[0]]=a[1].slice(0,-1).replace("!important","")+(-1!=n.indexOf(a[0])?" !important":"")));return s},flexAlignment:function(t){switch(t){case"left":return"flex-start";case"right":return"flex-end"}return t},wrapText:function(t){return t},recaptchaKeys:{default:"6Lc-J2waAAAAAA4F5ErF9Qt2tBvKnhWAOkKPrMoJ",alternate:"6LdUJ2waAAAAAENAw3WF9ZRXEL3d4mCLa5YLwuEA"},enableReCAPTCHA:function(t,e,a){var i=e&&e in this.recaptchaKeys?this.recaptchaKeys[e]:this.recaptchaKeys.default;grecaptcha.ready((function(){var e,s=$(t)[0]._form;s.options.submitHandler=function(t){"-"!=s.value("xtoken")&&s.submitHandler((function(){s.value("xtoken","-"),grecaptcha.reset(e),setTimeout((function(){s.$obj.find('[name="g-recaptcha-response"]').removeAttr("data-missing").removeData("missing")}),0),t&&t()}))},e=grecaptcha.render(s.$submits()[0],{sitekey:i,isolated:!0,callback:function(t){s.value("xtoken",t),s.$obj.triggerHandler("submit")}}),!0!==a&&s.disableSubmits()}))},keyHandler:function(t){var e=$(this);switch(t.keyCode){case 27:t.stopPropagation(),t.preventDefault(),e.blur();break;case 13:t.stopPropagation(),t.preventDefault(),e.trigger("click");break;case 8:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:t.preventDefault(),t.stopPropagation()}},clearAlert:function(){e.registry.unset("app.alert")},setAlert:function(t){e.registry.set("app.alert",JSON.stringify(t))},hasAlert:function(){return!!e.registry.get("app.alert")},getAlert:function(){var t,a,i,s;if(!(t=e.registry.get("app.alert")))return{};if("actions"in(a=JSON.parse(t))){for(s in i={},a.actions)!function(t){switch(t.action){case"hide":i[s]=function(){this.hide()};break;case"open":i[s]=function(){this.hide(),window.open(t.url)};break;case"redirect":i[s]=function(){this.hide(),window.location.href=t.url}}}(a.actions[s]);a.actions=i}return a},showAlert:function(){this.hasAlert()&&(e.dialog.show(this.getAlert()),this.clearAlert())},init:function(t,a){var i,s,n,o;e.instanceId=md5(Date.now()+Math.ceil(9999*Math.random()+1e3)),e.flags.lsdUnits=browser.canUse("width","100dvw"),e.$window=$(window),e.$document=$(document),e.$head=$("head"),e.$body=$("body"),e.$html=$("html"),breakpoints({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:["361px","480px"],xxsmall:[null,"360px"],xshort:"(max-height: 480px)",short:"(max-height: 640px)",tall:"(min-height: 641px)"}),$.event.special.destroyed={remove:function(t){t.handler&&t.handler()}},Element.prototype._addEventListener=Element.prototype.addEventListener,Element.prototype.addEventListener=function(t,e,a){return"wheel"==t&&(a={passive:!1}),this._addEventListener(t,e,a)},browser.mobile?(e.$body.addClass("is-touch"),e.touch.useTouch=!0,e.touch.useMouse=!1,e.touch.dragStartEvents="tapAndHold",e.touch.dragPreventDefault=function(t){return t.inTapAndHold},e.touch.scrollbars=!1):e.$body.addClass("is-nonTouch"),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,a){var i=this;setTimeout((function(){for(var s=atob(i.toDataURL(e,a).split(",")[1]),n=s.length,o=new Uint8Array(n),r=0;r<n;r++)o[r]=s.charCodeAt(r);t(new Blob([o],{type:e||"image/png"}))}))}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),i=a.length>>>0;if(0===i)return!1;var s=0|e,n=Math.max(s>=0?s:i-Math.abs(s),0);function o(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}for(;n<i;){if(o(a[n],t))return!0;n++}return!1}}),e.$body.attr("data-browser",browser.name),e.$window.on("load",(function(){window.setTimeout((function(){e.$body.removeClass("is-loading")}),100)})),$("form").form(),e.dialog.init(),e.progressOverlay.init(),e.globalEvents.init(),e.globalEvents.on("plan.init",(function(t){e.plan.sync(t,!0)&&e.plan.refresh()})),e.$body.on("click","a.behavior-replace",(function(t){var e=$(this).attr("href");t.preventDefault(),t.stopPropagation(),window.location.replace(e)})),e.$body.on("click","a.behavior-replace-long-wait",(function(t){var a=$(this).attr("href");t.preventDefault(),t.stopPropagation(),e.dialog.preshow(),window.setTimeout((function(){window.location.replace(a)}),250)})),e.$body.on("click","a.behavior-long-wait",(function(t){var a=$(this).attr("href");t.preventDefault(),t.stopPropagation(),e.dialog.preshow(),window.setTimeout((function(){window.location.href=a}),750)})),e.$body.on("click","a.behavior-download",(function(t){var a=$(this).attr("href");t.preventDefault(),t.stopPropagation(),e.dialog.preshow(),window.setTimeout((function(){window.location.href=a,e.dialog.show({title:"Downloading Zip",message:"Preparing your download. Please wait a moment.",actions:{Dismiss:function(){this.hide()}}})}),750)})),e.$body.on("click","a.behavior-requires-confirmation, a.behavior-requires-confirmation-long-wait",(function(t){var a=$(this),i=a.attr("data-confirm-href"),s=a.attr("data-confirm-message"),n=a.attr("data-confirm-action")?a.attr("data-confirm-action"):a.text(),o={};t.preventDefault(),t.stopPropagation(),o[n]=function(){a.hasClass("behavior-requires-confirmation-long-wait")?(e.dialog.preshow(),window.setTimeout((function(){window.location.href=i}),750)):window.location.href=i},o.Cancel=function(){this.hide()},e.dialog.show({title:"Are you sure?",message:s||null,actions:o})})),e.$body.on("click","a.behavior-requires-double-confirmation, a.behavior-requires-double-confirmation-long-wait",(function(t){var a=$(this),i=a.attr("data-confirm-href"),s=a.attr("data-confirm-action")?a.attr("data-confirm-action"):a.text(),n={};t.preventDefault(),t.stopPropagation(),n[s]=function(){a.hasClass("behavior-requires-double-confirmation-long-wait")?(e.dialog.preshow(),window.setTimeout((function(){window.location.href=i}),750)):window.location.href=i},n.Cancel=function(){this.hide()},e.dialog.show({title:"Are you sure?",message:null,confirmation:"Yes, I am sure I want to do this.",actions:n})})),e.$body.on("click",".behavior-requires-more-sites",(function(t){var a=$(this),i=parseInt(a.attr("data-sites-limit"));t.preventDefault(),t.stopPropagation(),e.dialog.show({title:"Out of sites :(",message:"Woops! You've reached your account's limit of <strong>"+i+"</strong> sites. Please either change to a different plan or delete a site and try again.",actions:{"Change Plan":function(){this.hide(),window.location.href="/dashboard/account/plan/change"},"Maybe Later":function(){this.hide()}}})})),e.$body.on("click",".behavior-requires-pro-plus",(function(t){$(this);t.preventDefault(),t.stopPropagation(),e.dialog.show({title:"Upgrade to Pro Plus",message:"Upgrade to the <strong>Pro Plus</strong> plan and get access to this and many other awesome features.",actions:{"Learn More":function(){this.hide(),window.location.href="/dashboard/account/plan/change"},"Maybe Later":function(){this.hide()}}})})),e.$body.on("click",".behavior-requires-verification",(function(t){$(this);t.preventDefault(),t.stopPropagation(),e.dialog.show({title:"Not Verified!",message:"Woops, looks like you haven't verified your account yet! Please click the link in the verification email we sent you before trying to upgrade."})})),e.$body.on("click","a.behavior-recommend-higher-plan",(function(t){var a=$(this).attr("href"),i={};t.preventDefault(),t.stopPropagation(),i["Choose a different plan"]=function(){this.hide(),window.location.href="/dashboard/account/plan/change"},i["Continue with this plan"]=function(){this.hide(),window.location.href=a},e.dialog.show({title:"Are you sure?",message:"One or more of your sites uses features not available with this plan. Upgrading to this plan will disable those features on your sites, but will otherwise leave them intact. What would you like to do?",actions:i})})),e.$body.on("click","a.behavior-unusable-plan",(function(t){var a=$(this),i=JSON.parse(unescape(a.attr("data-missing-perks")));t.preventDefault(),t.stopPropagation(),e.dialog.show({title:"Can't select plan :(",html:!0,message:'<p>Woops! Your account (or one or more of your sites) is currently using the following features that aren\'t available with the selected plan:</p><ul class="checklist special">'+function(){var t,e="";for(t=0;t<i.length;t++)e+="<li>"+i[t]+"</li>";return e}()+"</ul><p>Please select a different plan that includes the above features, or discontinue using them and try selecting this plan again.</p>"})})),e.$body.on("click","a.behavior-background-fetch",(function(t){var e=$(this).attr("href");t.preventDefault(),t.stopPropagation(),fetch(e),setTimeout((function(){window.location.reload()}),25)})),e.$body.on("click","ul.brand-selector.behavior-brand-steps > li > a",(function(t,e){var a=$(this),i=a.parent(),s=i.siblings(),n=a.parents("li").eq(1),o=n.siblings(),r=window.location.href.split("#")[0],l=a.attr("href").substr(1);t.preventDefault(),t.stopPropagation(),i.hasClass("active")||$.ajax({url:r+"/"+l,type:"GET",dataType:"json",success:function(t){var a;s.removeClass("active"),o.filter("[data-brand]").remove(),i.addClass("active"),a=t.excerpt.replace(/\<li\>/g,'<li data-brand="'+l+'">'),$(a).insertAfter(n),history.replaceState({},null,"#"+l),e||app.scrollTo({$target:n.next()})}})})),$("ul.brand-selector.behavior-brand-steps").each((function(){var t,e=$(this),a=window.location.hash.substr(1);a&&(t=e.find('a[href="#'+a+'"]')).length>0&&t.trigger("click",[!0])})),e.$body.on("change","select.jump-menu",(function(t){var e=$(this).val().trim();e&&(window.location.href=e)})),$("select.jump-menu").val(""),e.$body.on("click",'.toggle-wrapper.jump-menu > input[type="radio"]',(function(t){t.preventDefault();var e=$(this).val().trim();e&&(window.location.href=e)})),e.$body.on("click",".snippet:not(.disabled) a.url",(function(t){t.stopPropagation()})),e.$body.on("click",".snippet:not(.disabled)",(function(t){var e=$(this),a=e.find(".content");if(!e.hasClass("active")){if("clipboard"in navigator)navigator.clipboard.writeText(a.text());else{var i=document.createRange(),s=window.getSelection();a.prop("contentEditable",!0),a.prop("readonly",!0),i.selectNodeContents(a[0]),s.removeAllRanges(),s.addRange(i),document.execCommand("copy"),a.blur(),s.removeAllRanges(),a.prop("contentEditable",!1),a.prop("readonly",!1)}e.addClass("active"),setTimeout((function(){e.removeClass("active")}),1e3)}})),$(".printable").each((function(){$(this).find("table").each((function(){var t,e=$(this),a=e.children("tbody").first(),i=e.next(".actions");0!=i.length&&(t='<tr class="editable">',e.find("tr").first().children().each((function(e){var a=$(this)[0].tagName,i="";i+="<"+a+">",i+='<div class="string" contenteditable="true"></div>',0==e&&(i+='<div class="do-delete"></div>'),t+=i+="</"+a+">"})),t+="</tr>",e.on("click",".do-delete",(function(t){t.preventDefault(),t.stopPropagation(),$(this).parent().parent().remove()})),i.on("click",".do-add",(function(e){e.preventDefault(),e.stopPropagation(),a.append($(t))})))}))})),$(".defer-loading").length>0&&(s=$(".defer-loading"),n=e.$body.data("defer-from-id")?$("#"+e.$body.data("defer-from-id")):null,o=n&&n.length>0?n.offset().top:0,s.each((function(){var t=$(this),e=t.children("img").first(),a=e[0];t.css("background-image","url("+e.attr("src")+")").css("background-size","100% auto").css("background-position","top left").css("background-repeat","no-repeat"),e.css("opacity","0").css("transition","opacity 0.375s ease-in-out"),e.on("load",(function(i){"done"==e.data("src")&&(Date.now()-a._startLoad<375?(t.removeClass("loading"),t.css("background-image","none"),e.css("transition",""),e.css("opacity","1")):(t.removeClass("loading"),e.css("opacity","1"),setTimeout((function(){t.css("background-image","none")}),375)))}))})),i=function(){var t=document.documentElement.clientHeight,e="ios"==browser.os?document.body.scrollTop:document.documentElement.scrollTop,a=e+t;s.each((function(){var i=$(this),s=i.children("img").first(),n=s[0];if(null===n.offsetParent)return!0;if("done"===s.data("src"))return!0;var r,l=n.getBoundingClientRect(),c=e+Math.floor(l.top)-t,h=e+Math.ceil(l.bottom)+t;a>o&&c<=a&&h>=e&&(r=s.data("src"),s.data("src","done"),i.addClass("loading"),n._startLoad=Date.now(),s.attr("src",r))}))},e.$window.on("load resize scroll",i)),$(".plan-table").on("click",".plan > header .next:not(.last)",(function(){var t,e=$(this).parents(".plan"),a=e.data("level"),i=e.data("rank");0!=(t=e.siblings().filter('[data-level="'+a+'"][data-rank="'+(i+1)+'"]')).length&&(e.removeClass("active"),t.addClass("active"))})).on("click",".plan > header .previous:not(.first)",(function(){var t,e=$(this).parents(".plan"),a=e.data("level"),i=e.data("rank");0!=(t=e.siblings().filter('[data-level="'+a+'"][data-rank="'+(i-1)+'"]')).length&&(e.removeClass("active"),t.addClass("active"))})).children(".plan").each((function(){$(this).find(".title").append('<div class="next">Next</div><div class="previous">Previous</div>')})),e.$window.on("load",(function(){window.setTimeout((function(){e.showAlert()}),250)}))}};return e}(),app.init()},{breakpoints:"breakpoints",browser:"browser",form:"form",jquery:"jquery","jquery.touch":"jquery.touch",md5:"md5",tabs:"tabs",web:"web"}],2:[function(t,e,a){function i(t,e){var a,i=this;this.count=1e3,this.id=t.attr("id"),t.removeAttr("id"),this.name=t.attr("name"),t.removeAttr("name"),a=unescape(t.data("value")),t.removeData("value").removeAttr("data-value"),this.form=e,this.min=parseInt(t.data("min")),t.removeData("min").removeAttr("data-min"),isNaN(this.min)&&(this.min=1),1==t.data("optional")&&(this.min=0),this.max=parseInt(t.data("max")),t.removeData("max").removeAttr("data-max"),this.max||(this.max=0),this.type=t.data("type"),t.removeData("type").removeAttr("data-type"),this.type||(this.type="any"),this.label=t.data("label"),t.removeData("label").removeAttr("data-label"),this.label||(this.label="item"),this.delimiter=t.data("delimiter"),t.removeData("delimiter").removeAttr("data-delimiter"),this.delimiter||(this.delimiter="\t"),this.$template=$('<div class="item"><div class="inner"></div><div class="do-delete" tabindex="0"><svg><use xlink:href="#icon-delete"></use></svg><span class="label">Delete</span></div></div>'),t.children().appendTo(this.$template.children(".inner")),this.$template.find("input, textarea, select").prop("disabled",!1),this.$wrapper=t,this.$wrapper.on("keydown",".items input, .items textarea, .items select",(function(t){if(13===t.keyCode)t.stopPropagation(),t.stopImmediatePropagation(),$(this).blur()})).on("input",".items input, .items textarea, .items select",(function(t,e){t.stopPropagation()})).on("change",".items input, .items textarea, .items select",(function(t,e){var a=$(this).attr("id");t.stopPropagation(),"formList.val"!=e&&"init"!=e&&a!=i.id+"_count"&&i.sync("change")})).on("blur",".items input, .items textarea, .items select",(function(t){$(this).attr("id");t.stopPropagation(),i.sync("blur")})),this.$items=$('<div class="items"></div>').appendTo(this.$wrapper).on("keydown",".do-delete",(function(t){if(13!==t.keyCode)return app.keyHandler.apply(this,[t]);$(this).trigger("click")})).on("click",".do-delete",(function(t,e){var a=$(this).parents(".item");i.remove(i.itemIndex(a))})),this.$footer=$('<div class="footer"><span class="action-link add do-add" tabindex="0">Add '+this.label+" &hellip;</span></div>").appendTo(this.$wrapper),this.$footer.on("mousedown",".do-add",(function(t){$(this).addClass("is-clicked")})).on("blur",".do-add",(function(t){$(this).removeClass("is-clicked")})).on("click",".do-add",(function(t,e){t.preventDefault(),$(this).blur(),i.add(e)})).on("keydown",".do-add",(function(t){if(13!==t.keyCode)return app.keyHandler.apply(this,[t]);$(this).trigger("click",[!0])})).on("click",".do-dump",(function(t){t.stopPropagation(),t.preventDefault()})),this.$target=$("<textarea />").attr("id",this.id).attr("name",this.name).attr("data-type",this.type).data("type",this.type).attr("rows",5).css("position","absolute").css("width","0px").css("height","0px").css("visibility","hidden").css("z-index","-1").css("overflow","hidden").css("-moz-pointer-events","none").css("-webkit-pointer-events","none").css("-ms-pointer-events","none").css("pointer-events","none").prependTo(this.$wrapper),0==this.min&&this.$target.attr("data-optional","1").data("optional","1"),this.$target[0]._formList=this,this.val(a)}e.exports=i,i.prototype.itemIndex=function(t){return this.$wrapper.find(".item").index(t)},i.prototype.get=function(t){return this.$item.eq(t)},i.prototype.length=function(){return this.$items.children(".item").length},i.prototype.remove=function(t){this.removeBase(t)&&(this.lastAction={action:"remove",index:t},this.sync("remove"))},i.prototype.removeBase=function(t){return!(this.length()<=this.min)&&(this.get(t).remove(),!0)},i.prototype.add=function(t){var e;this.collapseSingular&&this.collapseAll(),(e=this.addBase())&&(this.form.initTypes(e),this.lastAction={action:"add",$item:e},t&&e.find("input, textarea, select").first().focus(),this.sync("add"))},i.prototype.addBase=function(){var t=this,e=this.$template.clone(!0),a=this.count++;if(!(this.max>0&&this.length()>=this.max))return e.data("id",a),e.find("input, textarea, select").each((function(){var e=$(this);e.attr("type"),e.parents(".field").first();e.attr("id",t.id+"_"+a),e.val(e.attr("value"))})),e.appendTo(this.$items),e},i.prototype.val=function(t){var e=this;if(void 0!==t){var a,i,s,n,o,r;if(l=t?t.split("\n"):[],n=Math.max(l.length,this.min),o=this.length(),0==n)this.$item&&this.$item.remove();else if(n>o){for(r=o;r<n;r++)this.addBase();this.$item=this.$items.children(".item")}else if(n<o){for(r=o;r>n;r--)this.removeBase(r-1);this.$item=this.$items.children(".item")}if(n>0)for(r in this.$items.find("input, textarea, select").val(""),l)s=(a=this.get(r)).data("id"),"checkbox"==(i=a.find('[id="'+this.id+"_"+s+'"]')).attr("type")?i.prop("checked",l[r]):i.val(l[r]),i.trigger("change",["formList.val"]);return this.sync("val"),this.$wrapper}var l=[];return this.$item.each((function(){var t,a=$(this),i=[];a.find("input, textarea, select").each((function(){var t=$(this),e=t.val().trim();"checkbox"==t.attr("type")?e=!!t.prop("checked"):i.push(e)})),""!==(t=i.join(e.delimiter))&&l.push(t)})),this.max>0&&l.length>this.max&&(l=l.slice(0,this.max)),l.join("\n")},i.prototype.sync=function(t){var e,a,i=this.length();if(this.$item=this.$items.children(".item"),0==i?status="empty":i<=this.min?status="min":this.max>0&&i>=this.max?status="max":status="",this.$wrapper.attr("data-status",status),(e=this.val())!=(a=this.$target.val()))switch(t){case"change":case"add":case"remove":case"val":this.$target.val(e),this.$target.trigger("change");break;case"blur":this.$target.val(e),this.$target.trigger("blur");break;case"target":this.val(a)}},i.prototype.dump=function(){},$.fn.formList=function(t){var e=$(this);if(0==this.length)return e;if(this.length>1){for(var a=0;a<this.length;a++)$(this[a]).formList(t);return e}return new i(e,t),e},$.valHandlers.push({condition:function(){return"TEXTAREA"==this.tagName&&"_formList"in this},get:function(){return $.fn.origVal.call($(this))},set:function(t){var e=$.fn.origVal.call($(this),t);return this._formList.sync("target"),e}})},{}],formArray:[function(t,e,a){function i(t,e){var a,i=this;this.count=1e3,this.states=[],this.isDragging=!1,this.hasDropTarget=!1,this.isLocked=!1,this.id=t.attr("id"),t.removeAttr("id"),this.name=t.attr("name"),t.removeAttr("name"),this.title=t.data("title"),t.removeData("title").removeAttr("data-title"),this.thumbnail=t.data("thumbnail"),t.removeData("thumbnail").removeAttr("data-thumbnail"),a=t.data("value"),t.removeData("value").removeAttr("data-value"),this.form=e,this.min=t.data("min"),t.removeData("min").removeAttr("data-min"),this.max=t.data("max"),t.removeData("max").removeAttr("data-max"),this.collapse="1"==t.data("collapse"),t.removeData("collapse").removeAttr("collapse"),this.collapseAlt="1"==t.data("collapse-alt"),t.removeData("collapse-alt").removeAttr("collapse-alt"),this.collapseSingular="1"==t.data("collapse-singular"),t.removeData("collapse-singular").removeAttr("collapse-singular"),t.data("clone-fields")?(this.cloneFields=t.data("clone-fields").split(","),t.removeData("clone-fields").removeAttr("clone-fields")):this.cloneFields=null,this.exposeCount="1"==t.data("expose-count"),t.removeData("expose-count").removeAttr("expose-count"),this.lastAction={action:null},this.$template=$('<div class="item'+(this.thumbnail?" with-thumbnail":"")+'" tabindex="0"><div class="header">'+(this.thumbnail?'<div class="thumbnail '+this.thumbnail+'"></div>':"")+'<span class="title"></span><div class="actions"><div class="do-delete"><svg><use xlink:href="#icon-delete"></use></svg><span class="label">Delete</span></div></div></div><div class="inner"></div></div>'),t.children().appendTo(this.$template.children(".inner")),this.$template.find("input, textarea, select").prop("disabled",!1),this.$placeholder=$('<div class="placeholder" />'),this.$wrapper=t,this.$wrapper.attr("id",this.id).attr("name",this.name).on("input","input, textarea, select",(function(t,e){t.stopPropagation()})).on("change","input, textarea, select",(function(t,e){var a=$(this).attr("id");t.stopPropagation(),"formArray.val"!=e&&"init"!=e&&a!=i.id+"_count"&&i.change("formArray.change",a)})).on("blur","input, textarea, select",(function(t){var e=$(this).attr("id");t.stopPropagation(),i.blur("formArray.blur",e)})).on("change.title",'[name^="'+this.title+'_"]',(function(t){var e=$(this),a=e.parents(".item"),i=e.val();t.stopPropagation(),i?"SELECT"==this.tagName&&(i=e.find('option[value="'+i+'"]').text()):i="(untitled)",a.find(".header .title").text(i)})),this.thumbnail&&this.$wrapper.on("change.thumbnail",function(){var t;switch(i.thumbnail){case"asset":t='[name^="assetId_"]';break;case"icon":t='[name^="type_"]';break;case"buttonIcon":t='[name^="iconType_"]'}return t}(),(function(t){var e,a,s,n=$(this).parents(".item");switch(t.stopPropagation(),e=n.find(".header .thumbnail"),i.thumbnail){case"asset":a=n.find('[name^="assetData_"]').val(),i.$wrapper.data("thumbnailDisabled")?e.addClass("is-disabled"):e.removeClass("is-disabled"),a?e.removeClass("is-unassigned").css("background-image",'url("'+a+'")'):e.addClass("is-unassigned").css("background-image","");break;case"icon":a=n.find('[name^="type_"]').val(),i.$wrapper.data("thumbnailDisabled")?e.addClass("is-disabled"):e.removeClass("is-disabled"),a?(s=app.build.icons.get(a),e.removeClass("is-unassigned").html('<svg><use xlink:href="'+(app.build.icons.inlined?"":app.build.icons.url)+"#icon-"+s.id+'"></use></svg>')):e.addClass("is-unassigned").html("");break;case"buttonIcon":a=n.find('[name^="iconType_"]').val(),i.$wrapper.data("thumbnailDisabled")?e.addClass("is-disabled"):e.removeClass("is-disabled"),a?(s=app.build.icons.get(a),e.removeClass("is-unassigned").html('<svg><use xlink:href="'+(app.build.icons.inlined?"":app.build.icons.url)+"#icon-"+s.id+'"></use></svg>')):e.addClass("is-unassigned").html("")}})),this.$items=$('<div class="items"></div>').appendTo(this.$wrapper).touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,dragThreshold:0,dragDelay:0,tapAndHoldDelay:browser.mobile?150:300,trackDocument:!0,delegateSelector:".item, .item > .inner, .do-delete",dropFilter:".item",preventDefault:{drag:app.touch.dragPreventDefault}}).on("mousedown",".item",(function(t){$(this).addClass("is-clicked")})).on("mousedown",".item > .inner",(function(t){$(this).parent().addClass("is-clicked")})).on("mousedown",".do-delete",(function(t){$(this).parents(".item").addClass("is-clicked")})).on("blur",".item",(function(t){t.target===this&&$(this).removeClass("is-clicked")})).on("click",".item",(function(t){var e=$(t.target);e.length>0&&"A"==e[0].tagName&&"#"==e.attr("href").charAt(0)||t.stopPropagation()})).on("keydown",".item:focus",(function(t){switch(t.keyCode){case 13:case 32:$(this).trigger("tap");break;default:return app.keyHandler.apply(this,[t])}})).on("tap dragStart tapAndHold",".do-delete",(function(t,e){var a=$(this).parents(".item");t.stopPropagation(),i.isLocked=!0,i.remove(i.itemIndex(a),(function(){i.isLocked=!1}))})).on("tap dragStart tapAndHold",".item > .inner",(function(t,e){t.stopPropagation()})).on("tap",".item",(function(t,e){var a=$(this);t.stopPropagation(),i.toggle(i.itemIndex(a)),i.$items.trigger("click")})).on(app.touch.dragStartEvents,".item",(function(t,e){var a=$(this),s=app.$document.scrollLeft(),n=app.$document.scrollTop(),o=a[0].getBoundingClientRect().width,r=a[0].getBoundingClientRect().height;t.stopPropagation(),i.isDragging=!0,i.$wrapper.addClass("is-dragging"),"android"==browser.os&&app.$body.css("overflow","hidden"),i.$placeholder.css("width",o+"px").css("height",r+"px").insertAfter(a),a.css("width",o+"px").css("height",r+"px").addClass("is-dragging").css("left",e.x-e.ex-s+"px").css("top",e.y-e.ey-n+"px")})).on("drag",".item",(function(t,e){var a=$(this),s=app.$document.scrollLeft(),n=app.$document.scrollTop();a.hasClass("is-dragging")&&i.isDragging&&(t.stopPropagation(),a.css("left",e.x-e.start.ex-s+"px").css("top",e.y-e.start.ey-n+"px"))})).on("dragEnd tapAndHoldEnd",".item",(function(t,e){var a=$(this);a.hasClass("is-dragging")&&i.isDragging&&(t.stopPropagation(),i.isDragging=!1,i.$wrapper.removeClass("is-dragging"),"android"==browser.os&&app.$body.css("overflow",""),i.$placeholder.detach().css("width","").css("height",""),a.removeClass("is-dragging").css("left","").css("top","").css("width","").css("height",""),i.hasDropTarget=!1,a.removeClass("is-dropTarget").removeClass("after").removeClass("before"))})).on("dragEnter",".item",(function(t,e){var a=$(this),s=$(e.element);a.hasClass("is-dragging")&&i.isDragging&&(t.stopPropagation(),i.hasDropTarget=!0,s.add(s.siblings()).removeClass("is-dropTarget").removeClass("after").removeClass("before"),s.addClass("is-dropTarget"))})).on("dragOver",".item",(function(t,e){var a=$(this),s=$(e.element);a.hasClass("is-dragging")&&i.isDragging&&(t.stopPropagation(),e.ey<Math.ceil(s.outerHeight()/2)?s.addClass("before").removeClass("after"):s.addClass("after").removeClass("before"))})).on("dragLeave",".item",(function(t,e){var a=$(this),s=$(e.element);a.hasClass("is-dragging")&&i.isDragging&&(t.stopPropagation(),i.hasDropTarget=!1,s.removeClass("is-dropTarget"))})).on("drop",".item",(function(t,e){var a,s=$(this),n=$(e.element);s.hasClass("is-dragging")&&i.isDragging&&i.hasDropTarget&&(t.stopPropagation(),i.hasDropTarget=!1,a=n.hasClass("after")?1:-1,n.removeClass("is-dropTarget").removeClass("after").removeClass("before"),i.move(s,n,a))})),this.$footer=$('<div class="footer"><ul class="actions fit"><li><span class="button do-add" tabindex="0">Add</span></li></ul></div>').appendTo(this.$wrapper),this.$footer.on("click",".do-add",(function(t,e){t.preventDefault(),$(this).blur(),i.isLocked||i.add(e)})).on("keydown",".do-add",(function(t){if(13!==t.keyCode)return app.keyHandler.apply(this,[t]);$(this).trigger("click",[!0])})).on("click",".do-dump",(function(t){t.stopPropagation(),t.preventDefault()})),this.exposeCount?this.$count=$('<input type="hidden" name="'+this.id+'_count" id="'+this.id+'_count" value="0" />').appendTo(this.$wrapper):this.$count=null,this.sync(),a&&this.val("object"==typeof a?a:JSON.parse(a))}e.exports=i,i.prototype.itemIndex=function(t){return this.$wrapper.find(".item").index(t)},i.prototype.get=function(t){return this.$item.eq(t)},i.prototype.length=function(){return this.$items.children(".item").length},i.prototype.toggle=function(t){!0===this.states[t]?(this.get(t).removeClass("collapsed"),this.states[t]=!1,this.collapseSingular&&this.collapseAll(t)):(this.get(t).addClass("collapsed"),this.states[t]=!0)},i.prototype.collapseAll=function(t){var e=0,a=this.length();for(e=0;e<a;e++)void 0!==t&&e==t||(this.get(e).addClass("collapsed"),this.states[e]=!0)},i.prototype.move=function(t,e,a){var i,s,n,o;if("object"==typeof t?(i=t,n=this.itemIndex(t)):(i=this.get(t),n=t),"object"==typeof e?(s=e,o=this.itemIndex(e)):(s=this.get(e),o=e),!(n==o||o<0||o>=this.length())){1==a?i.insertAfter(s):i.insertBefore(s);t=this.states[o];this.states[o]=this.states[n],this.states[n]=t,this.lastAction={action:"move",src:n,dest:o,pos:a},this.sync(),this.change("formArray.move")}},i.prototype.remove=function(t,e){this.removeBase(t)&&(this.lastAction={action:"remove",index:t},this.sync(),this.change("formArray.remove"),e&&setTimeout(e,250))},i.prototype.removeBase=function(t){return!(this.length()<=this.min)&&(this.get(t).remove(),this.states.splice(t,1),!0)},i.prototype.add=function(t){var e;this.collapseSingular&&this.collapseAll(),(e=this.addBase())&&(this.form.initTypes(e),this.form.initRequires(e,this.form.$obj),this.form.initConditions(e,this.form.$obj),this.lastAction={action:"add",$item:e},this.sync(),this.change("formArray.add"),t&&e.focus())},i.prototype.addBase=function(){var t=this.$template.clone(!0),e=this.count++;if(!(this.max>0&&this.length()>=this.max)){var a,i,s,n;if(t.data("id",e),this.$wrapper.attr("tabindex")&&t.data("tabindex","0").attr("tabindex",this.$wrapper.attr("tabindex")),t.find("input, textarea, select").each((function(){var a=$(this),i=a.attr("type"),s=(a.parents(".field").first(),a.attr("id")),n=a.attr("name"),o=t.find('label[for="'+s+'"]');a.attr("id",s.replace("_xxx","_"+e)).attr("name",n.replace("_xxx","_"+e)),o.length>0&&o.attr("for",s.replace("_xxx","_"+e)),"checkbox"!=i&&"radio"!=i&&o.on("click",(function(t){t.preventDefault()})),a.val(a.attr("value"))})),t.find("[data-requires]").each((function(){var t=$(this),a=t.attr("data-requires");a&&t.attr("data-requires",a.replace("_xxx","_"+e))})),this.cloneFields&&this.length()>0)for(n in a=this.$item.last(),this.cloneFields)s=this.cloneFields[n],i=a.find('[name^="'+s+'_"]').first(),t.find('[name^="'+s+'_"]').first().val(i.val());return t.appendTo(this.$items),t}},i.prototype.val=function(t){if(t){var e,a,i,s,n,o,r=Math.max(t.length,this.min),l=this.length();if(0==r)this.$item.remove();else if(r>l){for(e=l;e<r;e++)this.addBase();this.$item=this.$items.children(".item")}else if(r<l){for(e=l;e>r;e--)this.removeBase(e-1);this.$item=this.$items.children(".item")}if(r>0)for(e in this.$items.find("input, textarea, select").val(""),t){for(a in s=(n=this.get(e)).data("id"),t[e])if("object"==typeof t[e][a])for(i in t[e][a])"checkbox"==(o=n.find('[name="'+a+"."+i+"_"+s+'"]')).attr("type")?o.prop("checked",t[e][a][i]):o.val(t[e][a][i]);else"checkbox"==(o=n.find('[name="'+a+"_"+s+'"]')).attr("type")?o.prop("checked",t[e][a]):o.val(t[e][a]),o.trigger("change",["formArray.val"]);e in this.states?!1===this.states[e]?n.removeClass("collapsed"):n.addClass("collapsed"):this.collapse&&(!this.collapseAlt||e>0)?n.addClass("collapsed"):n.removeClass("collapsed"),this.form.initTypes(n),this.form.initRequires(n,this.form.$obj),this.form.initConditions(n,this.form.$obj)}return this.sync(),this.$wrapper}var c=[];return this.$item.each((function(){var t=$(this),e={};t.find("input, textarea, select").each((function(){var t=$(this),a=t.attr("name").replace(/_[0-9]+$/,"").split("."),i=t.val();"checkbox"==t.attr("type")&&(i=!!t.prop("checked")),2==a.length?(a[0]in e||(e[a[0]]={}),e[a[0]][a[1]]=i):e[a[0]]=i})),c.push(e)})),c},i.prototype.change=function(t,e){this.$wrapper.trigger("change",[t,e])},i.prototype.blur=function(t,e){this.$wrapper.trigger("blur",[t,e])},i.prototype.sync=function(){var t=this,e=this.length();if(this.$item=this.$items.children(".item"),0==e)this.$wrapper.addClass("empty");else switch(this.$wrapper.removeClass("empty"),this.min>0&&e<=this.min?this.$wrapper.addClass("is-min"):this.$wrapper.removeClass("is-min"),this.$items.find('[name^="'+this.title+'_"]').trigger("change.title",["formArray.sync"]),this.thumbnail){case"asset":this.$items.find('[name^="assetId_"]').trigger("change.thumbnail",["formArray.sync.asset"]);break;case"icon":this.$items.find('[name^="type_"]').trigger("change.thumbnail",["formArray.sync.icon"]);break;case"buttonIcon":this.$items.find('[name^="iconType_"]').trigger("change.thumbnail",["formArray.sync.thumbnail"])}this.states=[],this.$item.each((function(){t.states.push($(this).hasClass("collapsed"))})),this.exposeCount&&this.$count.val(e).attr("value",e).trigger("change",["formArray.sync"])},i.prototype.dump=function(){},i.prototype.scrollTop=function(){return $(window).scrollTop()},$.fn.formArray=function(t){var e=$(this);if(0==this.length)return e;if(this.length>1){for(var a=0;a<this.length;a++)$(this[a]).formArray(t);return e}return this[0]._formArray=new i(e,t),e},$.valHandlers.push({condition:function(){return"_formArray"in this},get:function(){return this._formArray.val()},set:function(t){return this._formArray.val(t)}})},{}],formColorPicker:[function(t,e,a){function i(t){var e,a,i,s,n,o,r,l,c,h=this;this.alpha="1"==t.data("alpha"),t.removeData("alpha").removeAttr("data-alpha"),this.optional="1"==t.data("optional"),this.optional&&t.attr("placeholder","(none)"),this.expand=t.hasClass("left")||t.hasClass("right"),t.attr("type","text").attr("data-manual","1").data("manual","1").attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").attr("maxlength",this.alpha?9:7).on("focus",(function(){if(e.addClass("focus"),h.expand){var t=e.parent(),a=t.parent();"static"==a.css("position")&&a.css("position","relative"),e.addClass("expand").css("width",a.width()).css("left",-1*t.position().left+"px"),a.css("position","")}})).on("blur",(function(){e.removeClass("focus"),h.expand&&e.removeClass("expand").css("width","").css("left","")})),o={$input:null,$swatch:null,currentValue:"#FFFFFF",init:function(t){var e=this;this.$input=t,h.optional&&(this.currentValue=""),this.$swatch=$('<div class="swatch" />').insertBefore(this.$input),this.$input.on("change input",(function(t,a,i){if(!i){var s,d,p=e.$input.val();if(""==p&&h.optional)n=!0,l.pos=0,r.pos[0]=100,r.pos[1]=0,h.alpha&&(c.pos=100);else{if(n=!1,!(s=h.hexaToRgba(p)))return;o.currentValue=p.toUpperCase(),d=h.rgbaToHsva(s.r,s.g,s.b,s.a),l.pos=100*d.h,r.pos[0]=100*d.s,r.pos[1]=100*(1-d.v),h.alpha?c.pos=100*d.a:c.pos=0}h.alpha&&c.sync(),l.sync(),r.sync(),e.sync(a,i)}})).on("blur",(function(){e.$input.val(o.currentValue)}))},sync:function(t,a){if(n)return e.addClass("empty"),this.$swatch.css("background-color",""),o.currentValue="",this.$input.val("").trigger("change",[t,!0]),void r.redraw();e.removeClass("empty"),l.changed()&&r.redraw();var i={h:null,s:null,v:null,a:null};i.h=l.pos/100,i.s=r.pos[0]/100,i.v=1-r.pos[1]/100,h.alpha?i.a=c.pos/100:i.a=1;var s=h.hsvaToRgba(i.h,i.s,i.v,i.a),d=h.rgbaToHexa(s.r,s.g,s.b,s.a),p="rgba("+s.r+","+s.g+","+s.b+","+s.a/255+")";this.$swatch.css("background-color",p),o.currentValue=d,this.$input.val()!=d&&this.$input.val(d).trigger("change",[t,!0])}},e=$('<div class="form-color-picker '+(t.attr("class")?t.attr("class"):"")+'"><div class="content"><div class="inner"><div class="hueSlider"><div class="cursor"></div><canvas></canvas></div><div class="picker"><div class="cursor"></div><canvas></canvas></div>'+(h.alpha?'<div class="alphaSlider"><div class="cursor"></div><canvas></canvas></div>':"")+"</div></div></div>").insertAfter(t),t.prependTo(e),e.find(".content").on("mousedown touchstart",(function(t){t.preventDefault(),t.stopPropagation()})),a=e.find(".picker"),r={$cursor:null,$wrapper:null,$canvas:null,canvas:null,context:null,imageData:null,pos:[0,0],dragTimeoutId:null,sync:function(){this.$cursor.css("left",this.pos[0]+"%").css("top",this.pos[1]+"%")},init:function(t){var e=this;this.$wrapper=t,this.$canvas=this.$wrapper.find("canvas").css("position","absolute").css("top",0).css("left",0).css("width","100%").css("height","100%").css("cursor","crosshair"),this.canvas=this.$canvas[0],this.canvas.width=100,this.canvas.height=100,this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,100,100),this.$cursor=this.$wrapper.find(".cursor"),this.$canvas.touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,trackDocument:!0,trackDocumentNormalize:!0,dragThreshold:0,dragDelay:0,preventDefault:{drag:!0}}).on("tap dragStart drag",(function(t,a){e.pos[0]=Math.round(a.ex/e.$canvas.width()*100),e.pos[1]=Math.round(a.ey/e.$canvas.height()*100),n=!1,clearTimeout(e.dragTimeoutId),e.dragTimeoutId=setTimeout((function(){e.sync(),o.sync()}),1)})),this.redraw()},redraw:function(){var t,e,a,i,s,n;for(t=0;t<100;t++)for(e=0;e<100;e++)a=e,i=99-t,n=h.hsvaToRgba(l.pos/100,e/100,t/100,1),s=4*(a+100*i),this.imageData.data[s+0]=n.r,this.imageData.data[s+1]=n.g,this.imageData.data[s+2]=n.b,this.imageData.data[s+3]=255;this.context.putImageData(this.imageData,0,0),this.sync()}},i=e.find(".hueSlider"),l={$cursor:null,$wrapper:null,$canvas:null,canvas:null,context:null,imageData:null,pos:0,lastPos:0,dragTimeoutId:null,changed:function(){return this.pos!=this.lastPos},sync:function(){this.$cursor.css("top",this.pos+"%")},init:function(t){var e=this;this.$wrapper=t,this.$canvas=this.$wrapper.find("canvas").css("position","absolute").css("top",0).css("left",0).css("width","100%").css("height","100%").css("cursor","crosshair").appendTo(this.$wrapper),this.canvas=this.$canvas[0],this.canvas.width=1,this.canvas.height=100,this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,1,100),this.$cursor=this.$wrapper.find(".cursor"),this.$canvas.touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,trackDocument:!0,trackDocumentNormalize:!0,dragThreshold:0,dragDelay:0,preventDefault:{drag:!0}}).on("tap dragStart drag",(function(t,a){e.lastPos=e.pos,e.pos=Math.round(a.ey/e.$canvas.height()*100),n=!1,clearTimeout(e.dragTimeoutId),e.dragTimeoutId=setTimeout((function(){e.sync(),o.sync()}),1)})).on("dragEnd",(function(t,a){e.lastPos=e.pos,e.pos=Math.round(a.end.ey/e.$canvas.height()*100),(e.pos>100||e.pos<0)&&(e.pos=Math.max(0,Math.min(100,e.lastPos))),n=!1,e.sync(),o.sync(),r.redraw()})),this.redraw()},redraw:function(){var t,e,a,i,s;for(t=0;t<100;t++)for(s=h.hsvaToRgba(t/100,1,1,1),a=t,e=0;e<1;e++)i=4*(e+1*a),this.imageData.data[i+0]=s.r,this.imageData.data[i+1]=s.g,this.imageData.data[i+2]=s.b,this.imageData.data[i+3]=s.a;this.context.putImageData(this.imageData,0,0),this.sync(),this.lastPos=this.pos}},s=e.find(".alphaSlider"),c={$cursor:null,$wrapper:null,$canvas:null,canvas:null,context:null,imageData:null,pos:0,lastPos:0,dragTimeoutId:null,changed:function(){return this.pos!=this.lastPos},sync:function(){this.$cursor.css("left",this.pos+"%")},init:function(t){var e=this;this.$wrapper=t,this.$canvas=this.$wrapper.find("canvas").css("position","absolute").css("top",0).css("left",0).css("width","100%").css("height","100%").css("cursor","crosshair").appendTo(this.$wrapper),this.canvas=this.$canvas[0],this.canvas.width=100,this.canvas.height=1,this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,100,1),this.$cursor=this.$wrapper.find(".cursor"),this.$canvas.touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,trackDocument:!0,trackDocumentNormalize:!0,dragThreshold:0,dragDelay:0,preventDefault:{drag:!0}}).on("tap dragStart drag",(function(t,a){e.lastPos=e.pos,e.pos=Math.round(a.ex/e.$canvas.width()*100),n=!1,clearTimeout(e.dragTimeoutId),e.dragTimeoutId=setTimeout((function(){e.sync(),o.sync()}),1)})),this.redraw()},redraw:function(){var t,e,a,i;for(t=0;t<100;t++)for(a=t,e=0;e<1;e++)i=4*(e+1*a),this.imageData.data[i+0]=255,this.imageData.data[i+1]=255,this.imageData.data[i+2]=255,this.imageData.data[i+3]=a/100*255;this.context.putImageData(this.imageData,0,0),this.sync(),this.lastPos=this.pos}},o.init(t),r.init(a),l.init(i),this.alpha&&c.init(s),t.triggerHandler("change",["init",!1])}void 0!==e&&(e.exports=i),i.prototype.rgbaToHsva=function(t,e,a,i){var s,n=Math.max(t,e,a),o=Math.min(t,e,a),r=n-o,l=0===n?0:r/n,c=n/255;i/=255;switch(n){case o:s=0;break;case t:s=e-a+r*(e<a?6:0),s/=6*r;break;case e:s=a-t+2*r,s/=6*r;break;case a:s=t-e+4*r,s/=6*r}return{h:s,s:l,v:c,a:i}},i.prototype.hexaToRgba=function(t){var e,a,i,s=255;if("#"!=t.charAt(0))return null;if(6==(t=t.substr(1)).length){if(e=parseInt(t.substr(0,2),16),a=parseInt(t.substr(2,2),16),i=parseInt(t.substr(4,2),16),isNaN(e)||isNaN(a)||isNaN(i))return null}else{if(8!=t.length||!this.alpha)return null;if(e=parseInt(t.substr(0,2),16),a=parseInt(t.substr(2,2),16),i=parseInt(t.substr(4,2),16),s=parseInt(t.substr(6,2),16),isNaN(e)||isNaN(a)||isNaN(i)||isNaN(s))return null}return{r:e,g:a,b:i,a:s}},i.prototype.rgbaToHexa=function(t,e,a,i){var s,n,o,r;return s=t.toString(16),n=e.toString(16),o=a.toString(16),r=i.toString(16),1==s.length&&(s="0"+s),1==n.length&&(n="0"+n),1==o.length&&(o="0"+o),1==r.length&&(r="0"+r),this.alpha&&"ff"!=r||(r=""),"#"+(s+n+o+r).toUpperCase()},i.prototype.hsvaToRgba=function(t,e,a,i){var s,n,o,r,l,c,h,d;switch(c=a*(1-e),h=a*(1-(l=6*t-(r=Math.floor(6*t)))*e),d=a*(1-(1-l)*e),r%6){case 0:s=a,n=d,o=c;break;case 1:s=h,n=a,o=c;break;case 2:s=c,n=a,o=d;break;case 3:s=c,n=h,o=a;break;case 4:s=d,n=c,o=a;break;case 5:s=a,n=c,o=h}return{r:Math.round(255*s),g:Math.round(255*n),b:Math.round(255*o),a:Math.round(255*i)}},$.fn.formColorPicker=function(){var t=$(this);if(0==this.length)return t;if(this.length>1){for(var e=0;e<this.length;e++)$(this[e]).formColorPicker();return t}return"_formColorPicker"in this[0]||(this[0]._formColorPicker=new i(t)),t}},{}],formImageUploader:[function(t,e,a){function i(t){var e;this.$obj=t,this.inputPrefix="",this.image={canvas:null,width:0,height:0,type:null,size:0,orientation:null,animated:!1,editable:!1,original:null,adjustments:{},crop:{topLeft:{x:null,y:null},bottomRight:{x:null,y:null}}},this.settings={mode:"data",editable:!0,forceCropMode:null,maxCanvasWH:2560,maxWH:1024,maxSize:2048,forceCanvas:!1,forceType:!1,circle:!1,minWidth:150,minHeight:150,inArray:!1},void 0!==(e=this.$obj.attr("data-mode"))&&(this.settings.mode=e),void 0!==(e=this.$obj.attr("data-editable"))&&(this.settings.editable="1"==e),void 0!==(e=this.$obj.attr("data-maxWH"))&&(this.settings.maxWH=parseInt(e),this.settings.maxCanvasWH=2.5*this.settings.maxWH,"safari"==browser.name&&(this.settings.maxCanvasWH=Math.min(this.settings.maxCanvasWH,4096))),void 0!==(e=this.$obj.attr("data-maxCanvasWH"))&&(this.settings.maxCanvasWH=parseInt(e)),void 0!==(e=this.$obj.attr("data-maxSize"))&&(this.settings.maxSize=parseInt(e)),void 0!==(e=this.$obj.attr("data-forceCanvas"))&&(this.settings.forceCanvas="1"==e),void 0!==(e=this.$obj.attr("data-forceType"))&&(this.settings.forceType=e),void 0!==(e=this.$obj.attr("data-forceCropMode"))&&(this.settings.forceCropMode=e),void 0!==(e=this.$obj.attr("data-circle"))&&(this.settings.circle="1"==e),void 0!==(e=this.$obj.attr("data-minWidth"))&&(this.settings.minWidth=parseInt(e)),void 0!==(e=this.$obj.attr("data-minHeight"))&&(this.settings.minHeight=parseInt(e)),void 0!==(e=this.$obj.attr("data-inArray"))&&(this.settings.inArray="1"==e),this.init()}void 0!==e&&(e.exports=i),i.prototype.init=function(){var t=this;this.$image=$("<img />").on("load",(function(){t.completeLoad()})),this.image.canvas=document.createElement("canvas"),this.$idInput=this.$obj.find(".id").css("position","absolute").css("width","0px").css("height","0px").css("visibility","hidden").css("z-index","-1").css("overflow","hidden").css("-moz-pointer-events","none").css("-webkit-pointer-events","none").css("-ms-pointer-events","none").css("pointer-events","none").on("--refresh-image",(function(){var e,a;e=t.$dataInput.val(),a=t.$idInput.val(),e&&a?(t.$thumbnail.css("background-image","url("+e+")"),t.$obj.removeClass("new")):(t.$thumbnail.css("background-image",""),t.$obj.addClass("new"))})),this.$dataInput=this.$obj.find(".data").css("display","none"),this.$fileInput=$('<input type="file" name="image" autocomplete="off" accept="image/jpeg,image/gif,image/png,image/svg+xml" />').on("change",(function(){t.load(t.$fileInput.prop("files")[0]),t.$fileInput.val("")})),this.$thumbnail=$('<div class="thumbnail"></div>').prependTo(this.$obj).css("background-size","cover").css("background-position","center").on("click",(function(e){e.preventDefault(),e.stopPropagation(),t.$idInput.prop("disabled")||t.$fileInput.trigger("click")})),this.$obj.on("click",".do-upload",(function(e){e.preventDefault(),e.stopPropagation(),t.$idInput.prop("disabled")||t.$fileInput.trigger("click")})).on("keydown",".do-upload",app.keyHandler).on("dragover",(function(e){return t.$obj.addClass("is-dragOver"),!1})).on("drop dragleave",(function(e){return t.$obj.removeClass("is-dragOver"),!1})).on("drop",(function(e){var a=e.originalEvent.dataTransfer.files;a.length;return t.load(a[0]),t.$fileInput.val(""),!1})),this.$obj.on("click",".do-clear",(function(e){var a;e.preventDefault(),e.stopPropagation(),t.$idInput.prop("disabled")||(t.$image.attr("src",""),t.$thumbnail.css("background-image",""),a=t.$dataInput.val(),"object"==t.settings.mode&&a&&app.objectUrl.is(a)&&app.objectUrl.revoke(a),t.$dataInput.val("").trigger(t.settings.inArray?"change-in-array":"change"),t.$idInput.val("").trigger("change",["formImageUploader.clear"]),t.$obj.addClass("new"),t.settings.inArray&&t.$obj.parents(".form-array").first().trigger("arrayChange"))})).on("keydown",".do-clear",app.keyHandler),this.$idInput.triggerHandler("--refresh-image"),s.init()},i.prototype.sync=function(t){var e,a,i,s,n,o,r,l,c,h,d,p=this,u=function(){(a=p.image.canvas.getContext("2d")).clearRect(0,0,p.image.canvas.width,p.image.canvas.height),p.$thumbnail.css("background-image","url("+t+")"),d=p.$dataInput.val(),"object"==p.settings.mode&&d&&app.objectUrl.is(d)&&app.objectUrl.revoke(d),p.$dataInput.val(t).trigger(p.settings.inArray?"change-in-array":"change"),p.$idInput.val(md5(String(Date.now())+t)).trigger("change",["formImageUploader.sync"]),p.$obj.removeClass("new"),p.image.animated=!1,p.image.editable=!1,p.settings.inArray&&p.$obj.parents(".form-array").first().trigger("arrayChange")};if(void 0===t){if(e=document.createElement("canvas"),a=e.getContext("2d"),e.width=this.image.crop.bottomRight.x-this.image.crop.topLeft.x,e.height=this.image.crop.bottomRight.y-this.image.crop.topLeft.y,a.drawImage(this.image.canvas,-1*this.image.crop.topLeft.x,-1*this.image.crop.topLeft.y),(e.width>this.settings.maxWH||e.height>this.settings.maxWH)&&(o=this.settings.maxWH/e.width,r=this.settings.maxWH/e.height,l=Math.min(o,r),c=Math.floor(l*e.width),h=Math.floor(l*e.height),n=(s=document.createElement("canvas")).getContext("2d"),s.width=c,s.height=h,n.drawImage(e,0,0,c,h),delete e,e=s),"image/png"==this.image.type){for(var g=a.getImageData(0,0,e.width,e.height).data,m=!1,f=0;f<g.length;f+=4)if(g[f+3]<255){m=!0;break}m||(this.image.type="image/jpeg")}if(this.settings.forceType)i=this.settings.forceType;else switch(this.image.type){case"image/svg+xml":i="image/svg+xml";break;case"image/png":case"image/gif":i="image/png";break;default:i="image/jpeg"}switch(this.settings.mode){case"object":case"object-manual":e.toBlob((function(a){t=app.objectUrl.create(a),delete e,u()}),i,1);break;default:t=e.toDataURL(i,1),delete e,u()}}else u()},i.prototype.load=function(t){var e=this;t&&this.getImageProperties(t,(function(a){var i,s;switch(e.image.type=a.type,e.image.size=a.size,e.image.orientation=a.orientation,e.image.animated=a.animated,e.settings.forceType){case"image/jpeg":case"image/png":case"image/gif":"image/svg+xml"==e.image.type&&(e.image.type="image/unknown",i="JPEG, PNG, or GIF");break;default:i="JPEG, PNG, GIF, or SVG"}switch(e.image.type){case"image/svg+xml":e.image.editable=!1;break;case"image/jpeg":case"image/png":e.image.editable=!0;break;case"image/gif":e.image.animated&&!e.settings.forceCanvas?e.image.editable=!1:e.image.editable=!0;break;default:return void app.dialog.show({title:"Invalid image type",message:"Sorry, images must be in either "+i+" format."})}Math.floor(e.image.size/1024)>e.settings.maxSize?app.dialog.show({title:"Image too large",message:"Sorry, images cannot exceed "+e.settings.maxSize/1024+"MB in file size."}):(s=app.objectUrl.create(t),e.$image.css("width","").css("height","").attr("src","").attr("src",s))}))},i.prototype.completeLoad=function(){var t,e,a,i,n,o,r,l=this,c=0,h=!1;if(this.image.editable||this.settings.forceCanvas){switch(this.image.orientation){case 1:default:break;case 2:h=!0;break;case 3:c=180;break;case 4:h=!0,c=180;break;case 5:h=!0,c=270;break;case 6:c=90;break;case 7:h=!0,c=90;break;case 8:c=-90}if(a=this.$image[0].width,i=this.$image[0].height,(a>this.settings.maxCanvasWH||i>this.settings.maxCanvasWH)&&(n=this.settings.maxCanvasWH/a,o=this.settings.maxCanvasWH/i,r=Math.min(n,o),a=Math.floor(r*a),i=Math.floor(r*i)),t=this.image.canvas.getContext("2d"),c>=360?c-=360:c<0&&(c+=360),0==c||180==Math.abs(c)?(this.image.canvas.width=a,this.image.canvas.height=i,t.translate(this.image.canvas.width/2,this.image.canvas.height/2),t.rotate(c*(Math.PI/180)),t.translate(this.image.canvas.width/-2,this.image.canvas.height/-2)):(this.image.canvas.width=i,this.image.canvas.height=a,t.translate(this.image.canvas.width/2,this.image.canvas.height/2),t.rotate(c*(Math.PI/180)),t.translate(this.image.canvas.height/-2,this.image.canvas.width/-2)),h?(t.scale(-1,1),t.drawImage(this.$image[0],-a,0,a,i)):t.drawImage(this.$image[0],0,0,a,i),this.image.width=this.image.canvas.width,this.image.height=this.image.canvas.height,(e=this.$image.attr("src"))&&app.objectUrl.is(e)&&app.objectUrl.revoke(e),this.$image.attr("src",""),!this.settings.editable)return this.image.crop.topLeft.x=0,this.image.crop.topLeft.y=0,this.image.crop.bottomRight.x=this.image.width,this.image.crop.bottomRight.y=this.image.height,this.sync(),void(this.image.orientation=null);s.show(this),window._formImageUploader=this}else switch(e=this.$image.attr("src"),l.settings.mode){case"object":case"object-manual":e&&app.objectUrl.is(e)?this.sync(e):app.objectUrl.createFromUrl(e,(function(t){l.sync(t)}));break;default:e&&app.dataUrl.is(e)&&this.sync(e),app.dataUrl.createFromUrl(e,(function(t){l.sync(t)}))}},i.prototype.getImageProperties_orientation=function(t){var e,a,i,s,n,o,r;if(65496!=(e=new DataView(t)).getUint16(0,!1))return null;for(a=Math.min(e.byteLength,65536),i=2;i<a;)if(s=e.getUint16(i,!1),i+=2,65505==s){if(1165519206!=e.getUint32(i+=2,!1))return null;for(n=18761==e.getUint16(i+=6,!1),i+=e.getUint32(i+4,n),o=e.getUint16(i,n),i+=2,r=0;r<o;r++)if(274==e.getUint16(i+12*r,n))return e.getUint16(i+12*r+8,n)}else{if(65280!=(65280&s))break;i+=e.getUint16(i,!1)}return null},i.prototype.getImageProperties_animated=function(t){var e,a,i,s,n,o;if(n=0,s=(e=new DataView(t)).byteLength,71!==e.getUint8(0)||73!==e.getUint8(1)||70!==e.getUint8(2)||56!==e.getUint8(3))return!1;for(a=0,i=s-3;a<i&&n<2;++a)0==e.getUint8(a)&&33===e.getUint8(a+1)&&249===e.getUint8(a+2)&&(o=a+4+e.getUint8(a+3))+1<s&&0===e.getUint8(o)&&(44===e.getUint8(o+1)||e.getUint8(o+1===33))&&n++;return n>1},i.prototype.getImageProperties=function(t,e){var a=this,i=new FileReader;i.onload=function(i){var s={};s.type=t.type,s.size=t.size,s.orientation=a.getImageProperties_orientation(i.target.result),s.animated=a.getImageProperties_animated(i.target.result),e(s)},i.readAsArrayBuffer(t)};var s={instance:null,$window:null,$body:null,$modal:null,$canvas:null,image:null,settings:null,canvasWrapper:{width:0,height:0,zoom:1},crop:{mode:null,maskCanvas:null,controlSize:60,minWidth:150,minHeight:150,topLeft:null,bottomRight:null,expandDirections:{topLeft:[-1,-1],top:[0,-1],topRight:[1,-1],right:[1,0],bottomRight:[1,1],bottom:[0,1],bottomLeft:[-1,1],left:[-1,0]},width:function(){return this.bottomRight.x-this.topLeft.x},height:function(){return this.bottomRight.y-this.topLeft.y}},init:function(){var t=this;this.$modal||(this.$body=$("body"),this.$window=$(window).on("resize orientationchange",(function(){t.isVisible()&&t.rescale()})),this.$modal=$('<div class="form-image-uploader-modal" tabindex="-1"><div class="inner"><div class="wrapper"><div class="canvas-wrapper"><canvas class="crop-mask"></canvas><div class="crop"><div class="controls" data-control="move"><div class="control top-left" data-control="topLeft"></div><div class="control top-right" data-control="topRight"></div><div class="control bottom-right" data-control="bottomRight"></div><div class="control bottom-left" data-control="bottomLeft"></div><div class="control top" data-control="top"></div><div class="control right" data-control="right"></div><div class="control bottom" data-control="bottom"></div><div class="control left" data-control="left"></div></div></div></div></div><header><div class="menu"><div data-name="crop" data-tooltip="Crop" data-tooltip-mode="form-image-uploader-option"><svg><use xlink:href="#icon-expand"></use></svg></div><div data-name="rotate" data-tooltip="Rotate" data-tooltip-mode="form-image-uploader-option"><svg><use xlink:href="#icon-redo"></use></svg></div><div data-name="flip-horizontally" data-tooltip="Flip Horizontally" data-tooltip-mode="form-image-uploader-option"><svg><use xlink:href="#icon-transfer"></use></svg></div><div data-name="flip-vertically" data-tooltip="Flip Vertically" data-tooltip-mode="form-image-uploader-option"><svg><use xlink:href="#icon-sort"></use></svg></div><div data-name="adjustments" data-tooltip="Adjustments" data-tooltip-mode="form-image-uploader-option"><span><svg><use xlink:href="#icon-adjustments"></use></svg></span></div><div data-name="effects" data-tooltip="Effects" data-tooltip-mode="form-image-uploader-option"><span><svg><use xlink:href="#icon-effects"></use></svg></span></div></div><ul class="actions fixed"><li><a href="#" class="button small do-cancel"><span class="label">Cancel</span></a></li><li><a href="#" class="button small do-change"><span class="label">Change</span></a></li><li><a href="#" class="button small special do-save"><span class="label">Accept</span></a></li></ul></header><footer><section data-name="adjustments"><div class="field"><label>Hue</label><input type="range" class="xsmall" name="hue" min="0" max="360" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div><div class="field"><label>Saturation</label><input type="range" class="xsmall" name="saturation" min="0" max="200" step="1" value="100" data-default="100"/><div class="reset disabled"></div></div><div class="field"><label>Brightness</label><input type="range" class="xsmall" name="brightness" min="0" max="200" step="1" value="100" data-default="100" /><div class="reset disabled"></div></div><div class="field"><label>Contrast</label><input type="range" class="xsmall" name="contrast" min="0" max="200" step="1" value="100" data-default="100" /><div class="reset disabled"></div></div></section><section data-name="effects"><div class="field"><label>Sepia</label><input type="range" class="xsmall" name="sepia" min="0" max="100" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div><div class="field"><label>Black and White</label><input type="range" class="xsmall" name="grayscale" min="0" max="100" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div><div class="field"><label>Invert</label><input type="range" class="xsmall" name="invert" min="0" max="100" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div><div class="field"><label>Blur</label><input type="range" class="xsmall" name="blur" min="0" max="100" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div></section></footer></div></div>').appendTo(this.$body).css("-moz-user-select","none").css("-webkit-user-select","none").css("-ms-user-select","none").css("user-select","none").on("click mousedown",(function(t){t.stopPropagation()})).on("keydown",(function(e){var a,i,s;switch(e.keyCode){case 13:e.preventDefault(),e.stopPropagation(),t.hide(!0);break;case 27:e.preventDefault(),e.stopPropagation(),t.hide();break;case 37:case 38:case 39:case 40:switch(e.preventDefault(),e.stopPropagation(),s=e.shiftKey?20:2,a=0,i=0,e.keyCode){case 37:a=-1*s;break;case 38:i=-1*s;break;case 39:a=s;break;case 40:i=s}t.cropControl_move(a,i),t.redrawCrop()}})),this.$wrapper=this.$modal.find(".wrapper"),this.$canvasWrapper=this.$modal.find(".canvas-wrapper").css("position","relative").css("max-width","100%"),this.$crop=this.$canvasWrapper.find(".crop").css("position","absolute").css("z-index",1).css("left",0).css("top",0),this.$cropMask=this.$canvasWrapper.find("canvas.crop-mask"),this.crop.maskCanvas=this.$cropMask[0],this.$cropControls=this.$crop.find(".controls").css("position","absolute").css("top",0).css("left",0).css("width","100%").css("height","100%"),x=.5*this.crop.controlSize*-1,this.$cropControls.find(".control").css("position","absolute").css("width",this.crop.controlSize+"px").css("height",this.crop.controlSize+"px"),this.$cropControls.find(".top-left").css("top",x).css("left",x),this.$cropControls.find(".top-right").css("top",x).css("right",x),this.$cropControls.find(".bottom-right").css("bottom",x).css("right",x),this.$cropControls.find(".bottom-left").css("bottom",x).css("left",x),this.$cropControls.find(".top").css("top",x).css("left","calc(50% + "+x+"px)"),this.$cropControls.find(".right").css("top","calc(50% + "+x+"px)").css("right",x),this.$cropControls.find(".bottom").css("bottom",x).css("left","calc(50% + "+x+"px)"),this.$cropControls.find(".left").css("top","calc(50% + "+x+"px)").css("left",x),this.$header=this.$modal.find("header"),this.$headerMenu=this.$header.find(".menu").on("click","div",(function(e){var a=$(this).data("name");switch($(this).addClass("clicked"),a){case"crop":if(t.settings.forceCropMode)return;t.cycleCropMode();break;case"rotate":t.rotateCanvas();break;case"flip-horizontally":t.flipCanvasHorizontally();break;case"flip-vertically":t.flipCanvasVertically();break;case"adjustments":t.toggleFooter("adjustments");break;case"effects":t.toggleFooter("effects")}})).on("mouseleave","div",(function(t){$(this).removeClass("clicked")})),this.$headerActions=this.$header.find(".actions").on("click",".do-save",(function(e){e.preventDefault(),e.stopPropagation(),t.hide(!0)})).on("click",".do-change",(function(e){e.preventDefault(),e.stopPropagation(),t.change()})).on("click",".do-cancel",(function(e){e.preventDefault(),e.stopPropagation(),t.hide()})),this.$footer=this.$modal.find("footer"),this.$footer.on("click",".reset",(function(t){var e=$(this).prev('input[type="range"]'),a=e.data("default");e.val(a).trigger("change")})),this.$footerInputs=this.$footer.find('input[type="range"]').on("change input",(function(e){var a=$(this),i=a.next(".reset");a.val()==a.data("default")?i.addClass("disabled"):i.removeClass("disabled"),t.adjustCanvas(t.footerValues())})),this.$canvasWrapper.touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,trackDocument:!0,trackDocumentNormalize:!0,dragThreshold:0,dragDelay:0,tapAndHoldDelay:browser.mobile?150:300,preventDefault:{drag:!0}}).on("doubleTap",(function(e,a){var i,s=$(document.elementFromPoint(a.x,a.y-scrollY)).data("control");s&&s in t.crop.expandDirections&&(i=t.crop.expandDirections[s],t.expandCrop(i[0],i[1]))})).on("dragStart tapAndHold",(function(e,a){var i="scrollY"in window?window.scrollY:window.pageYOffset,s=$(document.elementFromPoint(a.x,a.y-i)).data("control");t.$crop.addClass("active"),s&&(this._control="cropControl_"+s,this._x=a.x,this._y=a.y)})).on("dragEnd",(function(e,a){"_control"in this&&(delete this._x,delete this._y,delete this._control,t.$crop.removeClass("active"))})).on("drag",(function(e,a){if("_control"in this){var i=a.x-this._x,s=a.y-this._y;t[this._control](i,s,a.ex,a.ey),t.redrawCrop(),this._x=a.x,this._y=a.y}})))},resetCrop:function(){this.crop.topLeft.x=.2*this.image.width,this.crop.topLeft.y=.2*this.image.height,this.crop.bottomRight.x=.8*this.image.width,this.crop.bottomRight.y=.8*this.image.height,this.crop.width()<this.settings.minWidth&&(x=Math.ceil((this.settings.minWidth-this.crop.width())/2),this.crop.topLeft.x=Math.max(0,this.crop.topLeft.x-x),this.crop.bottomRight.x=Math.min(this.image.width,this.crop.bottomRight.x+x)),this.crop.height()<this.settings.minHeight&&(x=Math.ceil((this.settings.minHeight-this.crop.height())/2),this.crop.topLeft.y=Math.max(0,this.crop.topLeft.y-x),this.crop.bottomRight.y=Math.min(this.image.height,this.crop.bottomRight.y+x))},cycleCropMode:function(){"off"==this.crop.mode?this.setCropMode("free"):"free"==this.crop.mode?this.setCropMode("fixed"):this.setCropMode("off")},refreshCropMode:function(){null===this.crop.mode&&(this.crop.mode="free"),this.setCropMode(this.crop.mode,!0)},setCropMode:function(t,e){var a,i,s,n;if(this.settings.forceCropMode){if(!e)return;t=this.settings.forceCropMode}switch(this.crop.mode=t,this.crop.mode){case"free":a="crop-fixed",i="Fixed Crop",this.$crop.show(),this.$cropMask.show(),this.resetCrop();break;case"fixed":if(a="crop-off",i="No Cropping",this.$crop.show(),this.$cropMask.show(),e&&this.resetCrop(),(s=Math.floor(this.crop.bottomRight.x-this.crop.topLeft.x))==(n=Math.floor(this.crop.bottomRight.y-this.crop.topLeft.y)))return;n<s?(this.crop.topLeft.x=this.crop.topLeft.x+(s-n)/2,this.crop.bottomRight.x=this.crop.topLeft.x+n):(this.crop.topLeft.y=this.crop.topLeft.y+(n-s)/2,this.crop.bottomRight.y=this.crop.topLeft.y+s);break;case"off":a="crop-free",i="Crop",this.$crop.hide(),this.$cropMask.hide(),this.crop.topLeft.x=0,this.crop.topLeft.y=0,this.crop.bottomRight.x=this.image.width,this.crop.bottomRight.y=this.image.height}this.redrawCrop(),this.updateMenuItem("crop",a,i)},expandCrop:function(t,e){if("fixed"==this.crop.mode){var a;switch(t){case-1:switch(e){case-1:a=Math.min(this.crop.topLeft.x,this.crop.topLeft.y),this.crop.topLeft.x-=a,this.crop.topLeft.y-=a;break;case 0:a=Math.min(Math.min(this.crop.topLeft.x,this.crop.topLeft.y),Math.min(this.crop.topLeft.x,this.image.height-this.crop.bottomRight.y)),this.crop.topLeft.x-=a,this.crop.topLeft.y-=a,this.crop.bottomRight.x+=a,this.crop.bottomRight.y+=a;break;case 1:a=Math.min(this.crop.topLeft.x,this.image.height-this.crop.bottomRight.y),this.crop.topLeft.x-=a,this.crop.bottomRight.y+=a}break;case 0:switch(e){case-1:a=Math.min(Math.min(this.crop.topLeft.x,this.crop.topLeft.y),Math.min(this.image.width-this.crop.bottomRight.x,this.image.height-this.crop.bottomRight.y)),this.crop.topLeft.x-=a,this.crop.topLeft.y-=a,this.crop.bottomRight.x+=a,this.crop.bottomRight.y+=a;break;case 0:break;case 1:a=Math.min(Math.min(this.crop.topLeft.x,this.image.height-this.crop.bottomRight.y),Math.min(this.image.width-this.crop.bottomRight.x,this.image.height-this.crop.bottomRight.y)),this.crop.topLeft.x-=a,this.crop.topLeft.y-=a,this.crop.bottomRight.x+=a,this.crop.bottomRight.y+=a}break;case 1:switch(e){case-1:a=Math.min(this.image.width-this.crop.bottomRight.x,this.crop.topLeft.y),this.crop.bottomRight.x+=a,this.crop.topLeft.y-=a;break;case 0:a=Math.min(Math.min(this.image.width-this.crop.bottomRight.x,this.crop.topLeft.y),Math.min(this.image.width-this.crop.bottomRight.x,this.image.height-this.crop.bottomRight.y)),this.crop.topLeft.x-=a,this.crop.topLeft.y-=a,this.crop.bottomRight.x+=a,this.crop.bottomRight.y+=a;break;case 1:a=Math.min(this.image.width-this.crop.bottomRight.x,this.image.height-this.crop.bottomRight.y),this.crop.bottomRight.x+=a,this.crop.bottomRight.y+=a}}}else{switch(t){case-1:this.crop.topLeft.x=0;break;case 1:this.crop.bottomRight.x=this.image.width}switch(e){case-1:this.crop.topLeft.y=0;break;case 1:this.crop.bottomRight.y=this.image.height}}this.redrawCrop()},snapCrop:function(t,e,a,i,s,n){var o,r,l,c;o=(l={topLeft:{x:this.crop.topLeft.x,y:this.crop.topLeft.y},bottomRight:{x:this.crop.bottomRight.x,y:this.crop.bottomRight.y}}).bottomRight.x-l.topLeft.x,r=l.bottomRight.y-l.topLeft.y,Math.floor(t)<=0?(a&&(l.topLeft.x=0),s&&(c=o)>l.topLeft.x&&(l.bottomRight.x=c)):Math.ceil(t)>=this.canvasWrapper.width&&(a&&(c=this.image.width-o)<l.bottomRight.x&&(l.topLeft.x=c),s&&(l.bottomRight.x=this.image.width)),Math.floor(e)<=0?(i&&(l.topLeft.y=0),n&&(c=r)>l.topLeft.y&&(l.bottomRight.y=c)):Math.ceil(e)>=this.canvasWrapper.height&&(i&&(c=this.image.height-r)<l.bottomRight.y&&(l.topLeft.y=c),n&&(l.bottomRight.y=this.image.height)),o=l.bottomRight.x-l.topLeft.x,r=l.bottomRight.y-l.topLeft.y,o<this.settings.minWidth||r<this.settings.minHeight||"fixed"==this.crop.mode&&o!=r||(this.crop.topLeft.x=l.topLeft.x,this.crop.topLeft.y=l.topLeft.y,this.crop.bottomRight.x=l.bottomRight.x,this.crop.bottomRight.y=l.bottomRight.y)},moveCrop:function(t,e,a,i){(this.crop.topLeft.x+t<0||this.crop.bottomRight.x+t>this.image.width)&&(t=0),(this.crop.topLeft.y+e<0||this.crop.bottomRight.y+e>this.image.height)&&(e=0),this.crop.topLeft.x+=t,this.crop.topLeft.y+=e,this.crop.bottomRight.x+=t,this.crop.bottomRight.y+=e},resizeCrop:function(t,e,a,i){var s=this.crop.bottomRight.x-this.crop.topLeft.x,n=this.crop.bottomRight.y-this.crop.topLeft.y;if(t>0&&s-t<this.settings.minWidth&&(t=0),a<0&&s+a<this.settings.minWidth&&(a=0),e>0&&n-e<this.settings.minHeight&&(e=0),i<0&&n+i<this.settings.minHeight&&(i=0),"fixed"==this.crop.mode){if(t<0&&this.crop.topLeft.x+t<0)return;if(a>0&&this.crop.bottomRight.x+a>this.image.width)return;if(e<0&&this.crop.topLeft.y+e<0)return;if(i>0&&this.crop.bottomRight.y+i>this.image.height)return}this.crop.topLeft.x+=t,this.crop.topLeft.y+=e,this.crop.bottomRight.x+=a,this.crop.bottomRight.y+=i,this.crop.topLeft.x=Math.max(this.crop.topLeft.x,0),this.crop.topLeft.y=Math.max(this.crop.topLeft.y,0),this.crop.bottomRight.x=Math.min(this.crop.bottomRight.x,this.image.width),this.crop.bottomRight.y=Math.min(this.crop.bottomRight.y,this.image.height)},redrawCrop:function(){var t,e,a,i,s;e=this.canvasWrapper.zoom*this.crop.topLeft.x,a=this.canvasWrapper.zoom*this.crop.topLeft.y,i=this.canvasWrapper.zoom*(this.crop.bottomRight.x-this.crop.topLeft.x),s=this.canvasWrapper.zoom*(this.crop.bottomRight.y-this.crop.topLeft.y),(t=this.crop.maskCanvas.getContext("2d")).globalCompositeOperation="source-over",this.crop.maskCanvas.width=Math.ceil(this.canvasWrapper.width),this.crop.maskCanvas.height=Math.ceil(this.canvasWrapper.height),t.clearRect(0,0,this.crop.maskCanvas.width,this.crop.maskCanvas.height),t.fillStyle="rgba(0,0,0,0.5)",t.fillRect(0,0,this.crop.maskCanvas.width,this.crop.maskCanvas.height),t.globalCompositeOperation="destination-out",t.fillStyle="#fff",t.fillRect(e,a,i,s),this.$crop.css("left",e).css("top",a).width(i).height(s)},attach:function(t){this.instance=t,this.image=t.image,this.settings=t.settings,this.crop.topLeft=t.image.crop.topLeft,this.crop.bottomRight=t.image.crop.bottomRight,this.$canvas=$(t.image.canvas).addClass("image").prependTo(this.$canvasWrapper),this.image.adjustments={},this.updateOriginal()},detach:function(){this.clearOriginal(),this.$canvas.removeClass("image").detach(),this.crop.topLeft=null,this.crop.bottomRight=null,this.instance=null,this.image=null,this.settings=null},show:function(t){var e=this;this.attach(t),this.resetFooter(),this.refreshCropMode(),this.settings.forceCropMode?this.disableMenuItem("crop"):this.enableMenuItem("crop"),this.settings.circle?this.$modal.addClass("circle"):this.$modal.removeClass("circle"),"filter"in CanvasRenderingContext2D.prototype&&"safari"!=browser.name||(this.disableMenuItem("adjustments"),this.disableMenuItem("effects")),this.rescale(),this.$modal.addClass("visible"),window.setTimeout((function(){e.$modal.focus()}),250)},hide:function(t){t&&this.instance.sync(),this.detach(),this.$modal.removeClass("visible");var e=$("#ui");e.length>0&&e.focus()},change:function(){this.instance.$idInput.prop("disabled")||this.instance.$fileInput.trigger("click")},isVisible:function(){return!!this.$modal.hasClass("visible")},updateOriginal:function(){var t;t=this.image.canvas.getContext("2d"),this.image.original=t.getImageData(0,0,this.image.width,this.image.height)},restoreOriginal:function(){var t;this.image.original&&((t=this.image.canvas.getContext("2d")).filter="none",t.putImageData(this.image.original,0,0))},clearOriginal:function(){this.image.original=null},applyAdjustments:function(){var t,e,a=[];context=this.image.canvas.getContext("2d"),"blur"in this.image.adjustments?(e=Math.max(0,Math.min(100,this.image.adjustments.blur)),a.push("blur("+e/100*100+"px)"),t=2*e):t=0,"sepia"in this.image.adjustments&&a.push("sepia("+Math.max(0,Math.min(100,this.image.adjustments.sepia))+"%)"),"grayscale"in this.image.adjustments&&a.push("grayscale("+Math.max(0,Math.min(100,this.image.adjustments.grayscale))+"%)"),"invert"in this.image.adjustments&&a.push("invert("+Math.max(0,Math.min(100,this.image.adjustments.invert))+"%)"),"hue"in this.image.adjustments&&a.push("hue-rotate("+Math.max(0,Math.min(360,this.image.adjustments.hue))+"deg)"),"saturation"in this.image.adjustments&&a.push("saturate("+Math.max(0,Math.min(200,this.image.adjustments.saturation))+"%)"),"brightness"in this.image.adjustments&&a.push("brightness("+Math.max(0,Math.min(200,this.image.adjustments.brightness))+"%)"),"contrast"in this.image.adjustments&&a.push("contrast("+Math.max(0,Math.min(200,this.image.adjustments.contrast))+"%)"),context.filter=a.length>0?a.join(" "):"none",context.drawImage(this.image.canvas,-1*t,-1*t,this.image.width+2*t,this.image.height+2*t)},adjustCanvas:function(t){this.image.adjustments=t||{},this.restoreOriginal(),this.applyAdjustments()},flipCanvasHorizontally:function(){var t,e,a,i;this.restoreOriginal(),a=this.image.canvas.getContext("2d"),e=(t=document.createElement("canvas")).getContext("2d"),t.width=this.image.width,t.height=this.image.height,e.drawImage(this.image.canvas,0,0),a.save(),a.clearRect(0,0,this.image.width,this.image.height),a.translate(this.image.width,0),a.scale(-1,1),a.drawImage(t,0,0),a.restore(),delete t,i={topLeft:{x:this.crop.topLeft.x,y:this.crop.topLeft.y},bottomRight:{x:this.crop.bottomRight.x,y:this.crop.bottomRight.y}},this.crop.topLeft.x=this.image.width-i.bottomRight.x,this.crop.bottomRight.x=this.image.width-i.topLeft.x,this.updateOriginal(),this.applyAdjustments(),this.redrawCrop()},flipCanvasVertically:function(){var t,e,a,i;this.restoreOriginal(),a=this.image.canvas.getContext("2d"),e=(t=document.createElement("canvas")).getContext("2d"),t.width=this.image.width,t.height=this.image.height,e.drawImage(this.image.canvas,0,0),a.save(),a.clearRect(0,0,this.image.width,this.image.height),a.translate(0,this.image.height),a.scale(1,-1),a.drawImage(t,0,0),a.restore(),delete t,i={topLeft:{x:this.crop.topLeft.x,y:this.crop.topLeft.y},bottomRight:{x:this.crop.bottomRight.x,y:this.crop.bottomRight.y}},this.crop.topLeft.y=this.image.height-i.bottomRight.y,this.crop.bottomRight.y=this.image.height-i.topLeft.y,this.updateOriginal(),this.applyAdjustments(),this.redrawCrop()},rotateCanvas:function(){var t,e,a,i,s,n,o,r,l=Math.PI/180*90;this.restoreOriginal(),i=this.image.canvas.width/2,s=this.image.canvas.height/2,n=this.image.width,o=this.image.height,t=this.image.canvas.getContext("2d"),a=(e=document.createElement("canvas")).getContext("2d"),e.width=n,e.height=o,a.putImageData(t.getImageData(0,0,n,o),0,0),r=this.image.canvas.width,this.image.canvas.width=this.image.canvas.height,this.image.canvas.height=r,r=this.image.width,this.image.width=this.image.height,this.image.height=r,t.save(),t.translate(s,i),t.rotate(l),t.drawImage(e,n/-2,o/-2,n,o),t.restore(),r={topLeft:{x:this.crop.topLeft.x,y:this.crop.topLeft.y},bottomRight:{x:this.crop.bottomRight.x,y:this.crop.bottomRight.y}},this.crop.topLeft.x=this.image.width-r.bottomRight.y,this.crop.topLeft.y=r.topLeft.x,this.crop.bottomRight.x=this.image.width-r.topLeft.y,this.crop.bottomRight.y=r.bottomRight.x,delete e,this.updateOriginal(),this.applyAdjustments(),this.rescale()},rescale:function(){var t=this.$window.width(),e=this.$window.height(),a=this.$wrapper.width(),i=e-this.$header.outerHeight()-this.$footer.outerHeight(),s=padHeight=Math.max(60,t/1440*75);t<480?s=padHeight=40:t<736&&(s=padHeight=60),this.canvasWrapper.width=a-s,this.canvasWrapper.height=i-padHeight,this.image.width<this.canvasWrapper.width&&this.image.height<this.canvasWrapper.height?(this.canvasWrapper.zoom=1,this.canvasWrapper.width=this.image.width,this.canvasWrapper.height=this.image.height):(this.canvasWrapper.zoom=Math.min(this.canvasWrapper.height/this.image.height,this.canvasWrapper.width/this.image.width),this.canvasWrapper.width=this.canvasWrapper.zoom*this.image.width,this.canvasWrapper.height=this.canvasWrapper.zoom*this.image.height),this.$canvasWrapper.width(this.canvasWrapper.width).height(this.canvasWrapper.height),this.$canvas.width(this.canvasWrapper.zoom*this.image.width).height(this.canvasWrapper.zoom*this.image.height),this.redrawCrop()},cropControl_move:function(t,e,a,i){this.moveCrop(t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom,a,i),this.snapCrop(a,i,!0,!0,!0,!0)},cropControl_topLeft:function(t,e,a,i){"fixed"==this.crop.mode&&(Math.abs(t)>Math.abs(e)?e=t:t=e),this.resizeCrop(t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom,0,0),this.snapCrop(a,i,!0,!0,!1,!1)},cropControl_topRight:function(t,e,a,i){"fixed"==this.crop.mode&&(Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e),this.resizeCrop(0,e/this.canvasWrapper.zoom,t/this.canvasWrapper.zoom,0),this.snapCrop(a,i,!1,!0,!0,!1)},cropControl_bottomRight:function(t,e,a,i){"fixed"==this.crop.mode&&(Math.abs(t)>Math.abs(e)?e=t:t=e),this.resizeCrop(0,0,t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom),this.snapCrop(a,i,!1,!1,!0,!0)},cropControl_bottomLeft:function(t,e,a,i){"fixed"==this.crop.mode&&(Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e),this.resizeCrop(t/this.canvasWrapper.zoom,0,0,e/this.canvasWrapper.zoom),this.snapCrop(a,i,!0,!1,!1,!0)},cropControl_top:function(t,e,a,i){"fixed"==this.crop.mode?Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e:t=0,this.resizeCrop(-.5*t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom,.5*t/this.canvasWrapper.zoom,0),this.snapCrop(a,i,!1,!0,!1,!1)},cropControl_right:function(t,e,a,i){"fixed"==this.crop.mode?Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e:e=0,this.resizeCrop(0,.5*e/this.canvasWrapper.zoom,t/this.canvasWrapper.zoom,-.5*e/this.canvasWrapper.zoom),this.snapCrop(a,i,!1,!1,!0,!1)},cropControl_bottom:function(t,e,a,i){"fixed"==this.crop.mode?Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e:t=0,this.resizeCrop(.5*t/this.canvasWrapper.zoom,0,-.5*t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom),this.snapCrop(a,i,!1,!1,!1,!0)},cropControl_left:function(t,e,a,i){"fixed"==this.crop.mode?Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e:e=0,this.resizeCrop(t/this.canvasWrapper.zoom,-.5*e/this.canvasWrapper.zoom,0,.5*e/this.canvasWrapper.zoom),this.snapCrop(a,i,!0,!1,!1,!1)},headerMenuItems:{},footerSections:{},updateMenuItem:function(t,e,a){var i;(i=this.getMenuItem(t)).$icon.attr("xlink:href","#icon-"+e),i.$item.attr("data-tooltip",a)},getMenuItem:function(t){return t in this.headerMenuItems||($item=this.$headerMenu.find('[data-name="'+t+'"]'),$icon=$item.find("use"),this.headerMenuItems[t]={$item:$item,$icon:$icon}),this.headerMenuItems[t]},enableMenuItem:function(t){this.getMenuItem(t).$item.removeClass("disabled")},disableMenuItem:function(t){this.getMenuItem(t).$item.addClass("disabled")},toggleFooter:function(t){var e,a,i;t in this.footerSections||(this.footerSections[t]=this.$footer.find('[data-name="'+t+'"]')),e=this.footerSections[t],a=this.getMenuItem(t),i=e.hasClass("active"),this.$footer.children().removeClass("active"),this.$headerMenu.children().removeClass("active"),i||(e.addClass("active"),a.$item.addClass("active")),this.rescale()},resetFooter:function(){this.$headerMenu.children().removeClass("active"),this.$footer.children().removeClass("active"),this.$footerInputs.each((function(){var t=$(this),e=t.next(".reset");t.val(t.data("default")),e.addClass("disabled")}))},footerValues:function(){var t={};return this.$footerInputs.each((function(){var e=$(this),a=e.val();a!=e.data("default")&&(t[e.attr("name")]=a)})),t}};$.fn.formImageUploader=function(){var t=$(this);if(0==this.length)return t;if(this.length>1){for(var e=0;e<this.length;e++)$(this[e]).formImageUploader();return t}return"_formImageUploader"in this[0]?this[0]._formImageUploader.$idInput.triggerHandler("--refresh-image"):this[0]._formImageUploader=new i(t),t}},{}],formVideoUploader:[function(t,e,a){function i(t){var e,a=this;this.inputPrefix="",this.video={width:0,height:0,type:null,size:0},this.settings={mode:"data",maxSize:2048,inArray:!1},this.$window=$(window),this.$obj=t.addClass("form-video-uploader"),void 0!==(e=this.$obj.attr("data-mode"))&&(this.settings.mode=e),void 0!==(e=this.$obj.attr("data-maxSize"))&&(this.settings.maxSize=parseInt(e)),void 0!==(e=this.$obj.attr("data-inArray"))&&(this.settings.inArray="1"==e),this.$idInput=this.$obj.find(".id").css("position","absolute").css("width","0px").css("height","0px").css("visibility","hidden").css("z-index","-1").css("overflow","hidden").css("-moz-pointer-events","none").css("-webkit-pointer-events","none").css("-ms-pointer-events","none").css("pointer-events","none").on("--refresh-video",(function(){var t,e;t=a.$dataInput.val(),e=a.$idInput.val(),t&&e?(a.$thumbnail_video.attr("src",t),a.$obj.removeClass("new")):(a.$thumbnail_video.attr("src",""),a.$obj.addClass("new"))})),this.$dataInput=this.$obj.find(".data").css("display","none"),this.$thumbnail=$('<div class="thumbnail"></div>').appendTo(this.$obj).css("background-size","cover").css("background-position","center").on("click",(function(t){t.preventDefault(),t.stopPropagation(),a.$idInput.prop("disabled")||a.$fileInput.trigger("click")})),this.$thumbnail_img=$("<img />").appendTo(this.$thumbnail),this.$thumbnail_canvas=document.createElement("canvas"),this.$thumbnail_context=this.$thumbnail_canvas.getContext("2d"),this.$thumbnail_video=$('<video src="" autoplay muted playsinline />').on("loadeddata",(function(){var t,e,i,s;t=a.$thumbnail_canvas,e=a.$thumbnail_context,i=a.$thumbnail_video[0],t.width=i.videoWidth,t.height=i.videoHeight,setTimeout((function(){e.drawImage(i,0,0),s=t.toDataURL("image/jpeg",1),a.$thumbnail_img.attr("src",s),e.clearRect(0,0,t.width,t.height)}),0)})),this.$obj.on("click",".do-upload",(function(t){t.preventDefault(),t.stopPropagation(),a.$idInput.prop("disabled")||a.$fileInput.trigger("click")})).on("keydown",".do-upload",app.keyHandler).on("dragover",(function(t){return a.$obj.addClass("is-dragOver"),!1})).on("drop dragleave",(function(t){return a.$obj.removeClass("is-dragOver"),!1})).on("drop",(function(t){var e=t.originalEvent.dataTransfer.files;e.length;return a.load(e[0]),a.$fileInput.val(""),!1})),this.$obj.on("click",".do-clear",(function(t){t.preventDefault(),t.stopPropagation(),a.$idInput.prop("disabled")||(a.$video.attr("src",""),a.$thumbnail_video.attr("src",""),currentUrl=a.$dataInput.val(),"object"==a.settings.mode&&currentUrl&&app.objectUrl.is(currentUrl)&&app.objectUrl.revoke(currentUrl),a.$dataInput.val("").trigger(a.settings.inArray?"change-in-array":"change"),a.$idInput.val("").trigger("change",["formVideoUploader.clear"]),a.$obj.addClass("new"))})).on("keydown",".do-clear",app.keyHandler),this.$video=$("<video />").on("loadeddata",(function(){a.completeLoad()})),this.$fileInput=$('<input type="file" name="video" autocomplete="off" accept="video/mp4" />').on("change",(function(){a.load(a.$fileInput.prop("files")[0]),a.$fileInput.val("")})),this.$idInput.triggerHandler("--refresh-video")}void 0!==e&&(e.exports=i),i.prototype.sync=function(t){var e;this.$thumbnail_video.attr("src",t),e=this.$dataInput.val(),"object"==this.settings.mode&&e&&app.objectUrl.is(e)&&app.objectUrl.revoke(e),this.$dataInput.val(t).trigger(this.settings.inArray?"change-in-array":"change"),this.$idInput.val(md5(String(Date.now())+t)).trigger("change",["formVideoUploader.sync"]),this.$obj.removeClass("new")},i.prototype.load=function(t){var e=this;t&&this.getVideoProperties(t,(function(a){var i;switch(e.video.type=a.type,e.video.size=a.size,e.video.width=0,e.video.height=0,e.video.type){case"video/mp4":case"video/x-m4v":if(Math.floor(e.video.size/1024)>e.settings.maxSize)return void app.dialog.show({title:"Video too large",message:"Sorry, videos cannot exceed "+e.settings.maxSize/1024+"MB in file size."});break;default:return void app.dialog.show({title:"Invalid video type",message:"Sorry, videos must be in MP4 format."})}i=app.objectUrl.create(t),e.$video.attr("src","").attr("src",i)}))},i.prototype.completeLoad=function(){var t,e=this;switch(t=this.$video.attr("src"),this.video.width=this.$video[0].videoWidth,this.video.height=this.$video[0].videoHeight,this.settings.mode){case"object":case"object-manual":t&&app.objectUrl.is(t)?this.sync(t):app.objectUrl.createFromUrl(t,(function(t){e.sync(t)}));break;default:t&&app.dataUrl.is(t)?this.sync(t):app.dataUrl.createFromUrl(t,(function(t){e.sync(t)}))}},i.prototype.getVideoProperties=function(t,e){var a=new FileReader;a.onload=function(a){var i={};i.type=t.type,i.size=t.size,e(i)},a.readAsArrayBuffer(t)},$.fn.formVideoUploader=function(){var t=$(this);if(0==this.length)return t;if(this.length>1){for(var e=0;e<this.length;e++)$(this[e]).formVideoUploader();return t}return"_formVideoUploader"in this[0]||(this[0]._formVideoUploader=new i(t)),t}},{}],form:[function(t,e,a){$.valHandlers=[];t("./formColorPicker.js"),t("./formArray.js"),t("./formList.js"),t("./formImageUploader.js"),t("./formVideoUploader.js");function i(t,e){var a=this;this.$obj=t,this.options=$.extend({fields:{},types:{},verify:{},alertHandler:null,preSubmitHandler:null,conditionsHandler:null,submitHandler:function(t){a.submitHandler(t)},validation:!!t.is("[data-validation]"),explicitSubmit:!!t.is("[data-explicit-submit]")},e),this.$alert=$('<div class="alert">what what</div>').prependTo(this.$obj).hide(),this.alertTimers=[],this.initTypes(),this.initRequires(),this.initConditions(),this.initFields(),this.init()}e.exports=i,i.prototype.statusTables={"font-weight":{100:"Thin",200:"Extra Light",300:"Light",400:"Regular",500:"Medium",600:"Semi Bold",700:"Bold",800:"Extra Bold",900:"Heavy"}},i.prototype.option=function(t,e){return t in this.options?(void 0!==e&&(this.options[t]=e),this.options[t]):null},i.prototype.value=function(t,e){var a=this.$obj.find("#"==t.charAt(0)?'input[id="'+t.substr(1)+'"],select[id="'+t.substr(1)+'"]':'input[name="'+t+'"],select[name="'+t+'"]');return 0==a.length||!0===a.prop("disabled")?null:(void 0!==e&&a.val(e),a.val())},i.prototype.showAlert=function(t,e){var a=this,i=25*e.length;a.options.alertHandler&&a.options.alertHandler.apply(a),this.clearAlert(),a.$alert.addClass(t).text(e),a.alertTimers.push(window.setTimeout((function(){a.$alert.show(),a.$obj.hasClass("minimal")||app.scrollTo({$target:a.$alert,center:!0}),a.alertTimers.push(window.setTimeout((function(){a.$alert.addClass("visible")}),100)),a.alertTimers.push(window.setTimeout((function(){a.$alert.removeClass("visible")}),2e3+i)),a.alertTimers.push(window.setTimeout((function(){a.clearAlert()}),2250+i))}),0))},i.prototype.clearAlert=function(){for(var t in this.alertTimers)window.clearTimeout(this.alertTimers[t]);this.alertTimers=[],this.$alert.hide().text("").removeClass("visible").removeClass("error").removeClass("success")},i.prototype.flag=function(t,e,a){$parent=t.parent(),a?(t.attr("data-"+e,"1").data(e,"1"),$parent.hasClass("input-wrapper")&&$parent.attr("data-"+e,"1").data(e,"1")):(t.removeAttr("data-"+e).removeData(e),$parent.hasClass("input-wrapper")&&$parent.removeAttr("data-"+e).removeData(e))},i.prototype.is=function(t,e){return t in this.options.types?this.options.types[t](e):web.is(t,e)},i.prototype.isValid=function(){return 0===this.$obj.find("[data-invalid]:enabled,[data-missing]:enabled,[data-unverified]:enabled").length},i.prototype.submitHandler=function(t){var e,a=this,i=this.$obj.data("action"),s=!!this.$obj.hasClass("long-wait");i&&"#"!=i&&(s&&app.dialog.preshow(),e=function(){$.ajax({type:"POST",url:i+(-1==i.indexOf("?")?"?":"&")+"ajax=1",data:a.$obj.serialize(),dataType:"json",error:function(t,e,a){window.location.reload()},success:function(e){switch("reload"==e.action&&(e.action="redirect",e.url=window.location.href),e.action){case"alert":s&&app.dialog.hide(),a.showAlert(e.type,e.message);break;case"redirect":return"appAlert"in e&&app.registry.set("app.alert",JSON.stringify(e.appAlert)),void("delay"in e?(app.dialog.preshow(),setTimeout((function(){"replace"in e&&!1===e.replace?window.location.href=e.url:window.location.replace(e.url)}),e.delay)):"replace"in e&&!1===e.replace?window.location.href=e.url:window.location.replace(e.url));default:s&&app.dialog.hide(),a.showAlert("success","Ok.")}if(a.$obj.find('input[name="'+e._key+'"]').val(e[e._key]),t(),e.reset){if(!0===e.reset)a.$obj.get(0).reset();else if($.isArray(e.reset))for(k in e.reset)a.$obj.find('input[name="'+e.reset[k]+'"],select[name="'+e.reset[k]+'"]').val("").removeProp("checked");else a.$obj.find('input[name="'+e.reset+'"],select[name="'+e.reset+'"]').val("").removeProp("checked");a.$obj.find("input, select, textarea").trigger("change",["form.submitHandler.reset"])}e.focus&&a.$obj.find('input[name="'+e.focus+'"]').focus(),e.callback&&window[e.callback]()}})},window.setTimeout((function(){a.options.preSubmitHandler?a.options.preSubmitHandler.apply(a,[e]):e()}),250))},i.prototype.validate=function(t){var e=t.data("type"),a=1==t.data("optional")||!0===t.prop("disabled"),i=t.val();"checkbox"==t.attr("type")&&(i=t.prop("checked")?"on":""),e||(e="any"),""==i?(this.flag(t,"invalid",!1),this.flag(t,"missing",!a)):(this.flag(t,"missing",!1),this.flag(t,"invalid",!this.is(e,i))),this.isValid()?this.enableSubmits():this.disableSubmits()},i.prototype.$submits=function(){return $('input[form="'+this.$obj.attr("id")+'"]').add(this.$obj.find('input[type="submit"]'))},i.prototype.enableSubmits=function(){var t=this.$submits();t.prop("disabled",!1),t.removeClass("is-submitting")},i.prototype.disableSubmits=function(t){var e=this.$submits();e.prop("disabled",!0),t&&e.addClass("is-submitting")},i.prototype.initFields=function(){var t,e,a,i;for(t in this.options.fields)if(e=this.options.fields[t],i=(a=this.$obj.find('[name="'+t+'"]')).attr("type"),"value"in e){switch(i){case"radio":a.filter('[value="'+e.value+'"]').prop("checked",!0);break;case"checkbox":a.prop("checked",e.value);break;default:a.val(e.value)}a.triggerHandler("change")}},i.prototype.initRequires=function(t,e){var a=t||this.$obj,i=e||this.$obj,s=this;a.data("form-init-requires")||(a.data("form-init-requires",!0),a.find("[data-requires]").each((function(){var t,e,a,n,o,r,l,c,h,d,p=$(this),u=p.data("requires").split("&"),g=p.find("input,select,textarea").not("[data-requires-ignore]"),m=[];for(d in t=function(){var t,e,a=p.find("input,select,textarea,a,.button,.form-array,.form-array .item");if(m[0].or)for(e in t=!1,m)t=m[e].fTest()||t;else for(e in t=!0,m)t=m[e].fTest()&&t;if(t){if(!p.hasClass("inactive"))return;g.not("[data-requires-ignore]").prop("disabled",!1),s.options.explicitSubmit||g.not("[data-requires-ignore]").trigger("change",["form.initRequires.positive"]),p.removeClass("inactive"),a.each((function(){var t=$(this);t.data("tabindex")?(t.attr("tabindex",t.data("tabindex")),t.removeData("tabindex")):t.removeAttr("tabindex")})),p.hasClass("half")&&(p.hasClass("first")?p.next().removeClass("after-inactive"):p.prev().removeClass("before-inactive"))}else{if(p.hasClass("inactive"))return;g.not("[data-requires-ignore]").prop("disabled",!0),p.addClass("inactive"),a.each((function(){var t=$(this);t.attr("tabindex")&&t.data("tabindex",t.attr("tabindex")),t.attr("tabindex","-1")})),p.hasClass("half")&&(p.hasClass("first")?p.next().addClass("after-inactive"):p.prev().addClass("before-inactive"))}},u){switch(l=!1,c=!1,"!"==(e=(h=u[d].split("="))[0]).substr(-1)&&(e=e.substr(0,e.length-1),l=!0),"?"==e.substr(-1)&&(e=e.substr(0,e.length-1),c=!0),1==(a=h[1].split(",")).length&&(a=[a]),(n=i.find('[name="'+e+'"]').on("change",t)).attr("type")){case"radio":o=function(){return this.$input.filter(":checked").val()};break;case"checkbox":o=function(){return this.$input.prop("checked")?"on":"off"};break;default:o=function(){return this.$input.val()}}r=function(){var t,e=this.fValue();if(this.invert){for(t in this.value)if(e==this.value[t])return!1;return!0}for(t in this.value)if(e==this.value[t])return!0;return!1},m.push({key:e,value:a,$input:n,fValue:o,fTest:r,invert:l,or:c})}t()})))},i.prototype.conditionsHandler=function(t){var e=t||this.$obj,a=this;e.find("[data-conditions]").each((function(){var t,e,i=$(this),s=i.data("conditions").split(","),n=i.find("input,select,textarea").not("[data-conditions-ignore]"),o=i.find("input,select,textarea,a,.button,.form-array,.form-array .item"),r=!0;for(t=0;t<s.length;t++)"!"==(e=s[t]).charAt(0)?(e=e.substr(1),r=r&&!a.options.conditionsHandler(e)):r=r&&a.options.conditionsHandler(e);if(r){if(!i.hasClass("inactive"))return;n.not("[data-conditions-ignore]").prop("disabled",!1),a.options.explicitSubmit||n.not("[data-conditions-ignore]").trigger("change",["form.initConditions.positive"]),i.removeClass("inactive"),o.each((function(){var t=$(this);t.data("tabindex")?(t.attr("tabindex",t.data("tabindex")),t.removeData("tabindex")):t.removeAttr("tabindex")})),i.hasClass("half")&&(i.hasClass("first")?i.next().removeClass("after-inactive"):i.prev().removeClass("before-inactive"))}else{if(i.hasClass("inactive"))return;n.not("[data-conditions-ignore]").prop("disabled",!0),i.addClass("inactive"),o.each((function(){var t=$(this);t.attr("tabindex")&&t.data("tabindex",t.attr("tabindex")),t.attr("tabindex","-1")})),i.hasClass("half")&&(i.hasClass("first")?i.next().addClass("after-inactive"):i.prev().addClass("before-inactive"))}}))},i.prototype.refreshConditions=function(){this.conditionsHandler(this.$obj)},i.prototype.initConditions=function(t,e){var a=t||this.$obj,i=e||this.$obj,s=this;if(!a.data("form-init-conditions")){a.data("form-init-conditions",!0);var n=function(t){return s.conditionsHandler(i)};a.on("change","input, select, textarea",n),n()}},i.prototype.initTypes=function(t){var e=t||this.$obj;e.data("form-init-types")||(e.data("form-init-types",!0),t||(this.initType_Array(this.$obj),this.initType_List(e)),this.initType_ImageUploader(e),this.initType_VideoUploader(e),this.initType_ColorPicker(e),this.initType_Toggle(e),this.initType_Range(e),this.initType_Textarea(e),this.initType_Text(e))},i.prototype.initType_Array=function(t){t.find(".form-array").formArray(this)},i.prototype.initType_List=function(t){t.find(".form-list").formList(this)},i.prototype.initType_ImageUploader=function(t){t.find(".form-image-uploader").formImageUploader()},i.prototype.initType_VideoUploader=function(t){t.find(".form-video-uploader").formVideoUploader()},i.prototype.initType_ColorPicker=function(t){t.find('input[type="hexcolor"]').formColorPicker()},i.prototype.initType_Text=function(t){t.on("focus",".input-wrapper input",(function(t){$(this).parent().addClass("focus")})).on("blur",".input-wrapper input",(function(t){$(this).parent().removeClass("focus")})).on("mousedown",".input-wrapper .prefix",(function(t){t.preventDefault(),t.stopPropagation(),$(this).next().focus()})).on("mousedown",".input-wrapper .suffix",(function(t){t.preventDefault(),t.stopPropagation(),$(this).prev().focus()})),t.find('input[type="text"][data-prefix], input[type="text"][data-suffix]').each((function(){var t,e,a,i=$(this);a=i.data("suffix"),e=i.data("prefix"),t=$('<div class="input-wrapper" />').insertBefore(i),i.removeAttr("data-prefix").removeAttr("data-suffix").removeData("prefix").removeData("suffix").attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").appendTo(t),e&&($('<div class="prefix">'+e+"</div>").prependTo(t),t.addClass("with-prefix")),a&&($('<div class="suffix">'+a+"</div>").appendTo(t),t.addClass("with-suffix"))})),t.find('input[type="text"][data-inline-suffix]').each((function(){var t,e,a,i,s=$(this);e=s.data("inline-suffix"),a=s.attr("maxlength"),i=s.attr("placeholder"),s.attr("type","hidden").removeAttr("placeholder").removeAttr("maxlength").removeAttr("data-inline-suffix").removeData("inline-suffix").on("change",(function(e){var i=s.val();i>a&&(i=i.substr(0,a),s.val(i)),t.text(i)})),t=$('<div class="input-facade text"></div>').attr("contenteditable","true").attr("data-inline-suffix",e).attr("data-placeholder",i).attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").insertAfter(s).on("keydown",(function(e){switch(e.keyCode){case 13:case 27:e.preventDefault(),e.stopPropagation(),t.blur();break;case 32:e.preventDefault(),e.stopPropagation()}})).on("change input",(function(e){var i=t.text();if(""==i.trim())i="",t.text("");else if(i.length>a){var n=window.getSelection(),o=n.getRangeAt(0).endOffset-1;i=i.substr(0,a),t.text(i),n.collapse(t[0].firstChild,Math.min(a,o+1))}s.val(i)})).on("keyup",(function(e){9==e.keyCode&&getSelection().selectAllChildren(t[0])})).on("blur",(function(t){getSelection().removeAllRanges()})),s.triggerHandler("change")})),t.find('input[type="text"][data-suffixes]').each((function(){var t,e,a,i,s,n=$(this),o=n.next("select"),r=o.children("option");i=$('<div class="input-wrapper" />').addClass("with-suffixes").insertBefore(n),n.attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").on("keydown blur mousedown",(function(e){t.removeClass("active")})).appendTo(i),o.hide().appendTo(i).attr("data-optional","1").data("optional","1").on("change",(function(t,i){var s=o.val(),l=r.filter('[value="'+s+'"]').text();t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),a.text(l),e.removeClass("selected"),e.filter('[data-value="'+s+'"]').addClass("selected"),n.trigger("change-suffixes",[s,l]),"form.initType_Text.suffixes.click"==i&&""!=$.fn.origVal.call(n)&&n.trigger("input").trigger("change")})),r=o.children(),t=$('<div class="suffixes"><div class="status"></div><div class="options">'+(s="",r.each((function(){var t=$(this);s+='<div class="option" data-value="'+t.attr("value")+'"><span>'+t.text()+"</span></div>"})),s+"</div></div>")).appendTo(i).on("mousedown",(function(t){t.preventDefault(),t.stopPropagation()})).on("click",".option:not(.disabled)",(function(e){var a=$(this).data("value");t.removeClass("active"),o.val()!=a&&o.val(a).triggerHandler("change",["form.initType_Text.suffixes.click"])})),a=t.children(".status").on("click",(function(e){browser.mobile||n.focus(),t.toggleClass("active"),n.trigger("toggle-suffixes")})),e=t.children(".options").children(),o.triggerHandler("change",["form.initType_Text.suffixes.init"])}))},i.prototype.initType_Toggle=function(t){t.find(".toggle-wrapper").attr("tabIndex","0"),t.on("blur",".toggle-wrapper",(function(t){$(this).removeClass("is-clicked")})).on("mousedown",".toggle-wrapper",(function(t){$(this).addClass("is-clicked")})).on("keydown",".toggle-wrapper",(function(t){var e,a=$(this),i=a.find("input"),s=i.filter(":checked");switch(t.keyCode){case 39:case 32:case 13:t.preventDefault(),t.stopPropagation(),0==(e=s.next("label").next("input")).length&&(e=i.first()),e.trigger("click");break;case 37:t.preventDefault(),t.stopPropagation(),0==(e=s.prev("label").prev("input")).length&&(e=i.last()),e.trigger("click");break;case 27:t.preventDefault(),t.stopPropagation(),a.blur();break;default:return app.keyHandler.apply(this,[t])}}))},i.prototype.initType_Range=function(t){var e=this;t.find('input[type="range"][data-status]').each((function(){var t,a,i,s,n,o=$(this),r=$('<div class="input-range-status" spellcheck="false" contenteditable />').insertBefore(o),l=o.data("status"),c=o.data("status-args");if(c){for(a=c.split("&"),s={},n=0;n<a.length;n++)s[(i=a[n].split("="))[0].toString()]=i[1];c=s}else c={};o.on("change.status",(function(t){var a,i=o.val(),s=l.split(",");if("rename"==s[0]?i.toString()in c?i=c[i.toString()]:a=s.length>0?s[1]:null:a=s[0],a)switch(a){case"seconds":i=parseFloat(i)/1e3+"s";break;case"degrees":i+="&deg;";break;case"percentage":i+="%";break;case"points":i+="pt";break;case"font-weight":i in e.statusTables["font-weight"]&&(i=e.statusTables["font-weight"][i]);break;case"animation-intensity":i=0==i?"Min":10==i?"Max":i<5?"Less":i>5?"More":"Normal";break;case"animation-stagger":i=-125==i?"Off":parseFloat(i)/1e3+"s"}r.html(i)})).triggerHandler("change.status"),r.on("keydown",(function(t){13!=t.keyCode&&27!=t.keyCode||(t.stopPropagation(),t.preventDefault(),r.blur())})).on("focus",(function(e){var a;switch(t=r.text(),l){case"rename":case"font-weight":a=t;break;default:(null===(a=parseFloat(t))||isNaN(a))&&(a="")}r.text(a),setTimeout((function(){getSelection().selectAllChildren(r[0])}),0)})).on("blur",(function(a){var i,s,n,h=r.text(),d=parseFloat(o.attr("min")),p=parseFloat(o.attr("max"));switch(l){case"rename":for(i in s=web.friendlyfy(h.replace(/\s/g,"")),n=null,c)if(s==web.friendlyfy(c[i].replace(/\s/g,""))){n=i;break}null===(s=n)&&(s=null===(s=parseFloat(h))||isNaN(s)?null:Math.min(Math.max(s,d),p));break;case"seconds":null===(s=parseFloat(h))||isNaN(s)?s=null:(s=parseInt(1e3*s),s=Math.min(Math.max(s,d),p));break;case"font-weight":for(i in s=web.friendlyfy(h.replace(/\s/g,"")),n=null,e.statusTables["font-weight"])if(s==web.friendlyfy(e.statusTables["font-weight"][i].replace(/\s/g,""))||s==i){n=i;break}s=n;break;default:s=null===(s=parseFloat(h))||isNaN(s)?null:Math.min(Math.max(s,d),p)}null!==s?o.val(s).trigger("change",["form.initType_Range.rangeStatus"]):r.text(t),getSelection().removeAllRanges()}))}))},i.prototype.initType_Textarea=function(t){var e=this;t.find("textarea[data-autosize]").each((function(){var t,a,i,s,n,o,r,l=$(this),c=function(){var t,e=l.val().trim(),i=e.split("\n");if(a.text(""),""!=e)for(t=0;t<i.length;t++)a.append("<div>"+(""==i[t]?"<br />":web.escapeHTML(String(i[t])))+"</div>")};i=l.attr("maxlength"),s=null!=l.data("autofocus"),n=null!=l.data("allowNewline"),o=null!=l.data("siteLanguageDependent"),l.data("content"),r=l.attr("placeholder"),t=$('<div class="input-textarea-autosize">').insertBefore(l),(a=$('<div class="input-facade textarea" '+(s?" data-autofocus":"")+(o?" data-site-language-dependent":"")+" />").attr("contenteditable","true").attr("tabindex","0").attr("data-placeholder",r).on("input",(function(t){var e,s="";for(e=0;e<a[0].childNodes.length;e++)s+=a[0].childNodes[e].textContent.trim()+"\n";s=(s=s.trim()).substring(0,Math.min(i,s.length)),l.val(s).trigger("input")})).on("keydown",(function(t){switch(t.keyCode){case 13:t.ctrlKey||!n?(t.preventDefault(),a.blur(),e.$submits().prop("disabled")||0!=l.parents(".form-array").length||e.options.explicitSubmit||e.$obj.trigger("submit")):t.stopPropagation();break;case 66:case 98:case 73:case 105:case 85:case 117:t.ctrlKey&&(t.preventDefault(),t.stopPropagation())}})).on("keyup",(function(t){var e,i;9==t.keyCode&&a.is(":focus")&&(e=window.getSelection(),(i=document.createRange()).selectNodeContents(a[0]),e.removeAllRanges(),e.addRange(i))})).on("blur",(function(t){var e;window.getSelection().removeAllRanges(),e=l.val(),l.val(web.condenseBlankLines(e)),l.trigger("change"),c(),l.trigger("blur")})).on("paste",(function(t){var e;t.preventDefault(),t.originalEvent.preventDefault(),"clipboardData"in t.originalEvent&&"getData"in t.originalEvent.clipboardData&&(e=t.originalEvent.clipboardData.getData("text/plain"),e=web.escapeHTML(e),document.execCommand("insertHTML",!1,e))})).appendTo(t))[0].setSelectionRange=function(t,e){var i,s;i=window.getSelection(),(s=document.createRange()).selectNodeContents(a[0]),s.collapse(),i.removeAllRanges(),i.addRange(s)},l.removeAttr("data-autosize").removeAttr("data-autofocus").removeAttr("data-allow-newline").removeAttr("data-content").on("focus --focus",(function(){a.focus()})).on("change",(function(){c()})).prependTo(t).triggerHandler("change")}))},i.prototype.init=function(){var t=this;if(this.$obj.on("input",'input[type="range"]',(function(){$(this).trigger("change",["form.rangeFix"])})),this.$obj.on("click","label",(function(t){var e=$(this).prev().attr("type");"checkbox"!=e&&"radio"!=e&&t.preventDefault()})),this.$obj.on("keydown","input, textarea, select",(function(t){27==t.keyCode&&$(this).blur()})),this.options.explicitSubmit?this.$obj.on("keydown","input,select,textarea",(function(t){var e=$(this);13==t.keyCode&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.blur())})):this.$obj.on("keydown","input,select,textarea",(function(e){13==e.keyCode&&e.ctrlKey&&t.$obj.trigger("submit")})),this.options.validation&&this.$obj.on("change blur keyup","input,select,textarea",(function(){t.validate($(this))})),!$.isEmptyObject(this.options.verify)){var e,a,i;for(e in this.$obj.on("--refresh-verify",(function(e){t.$obj.find("input,select,textarea").each((function(){var e=$(this),a=e.attr("name"),i=e.val();a in t.options.verify&&!0!==e.prop("disabled")&&(""==i?t.flag(e,"unverified",!0):e.data("verify-originalValue",i))}))})),this.$obj.on("keydown","input,select,textarea",(function(e){var a=$(this),i=a.attr("name");13==e.keyCode&&i in t.options.verify&&!1===a.prop("disabled")&&(e.preventDefault(),e.stopPropagation(),a.blur())})).on("input","input,select,textarea",(function(e){var a=$(this),i=a.parent(),s=i.hasClass("input-wrapper")?i.next(".message"):a.next(".message"),n=a.attr("name"),o=a.val();n in t.options.verify&&!0!==a.prop("disabled")&&(s.text("").removeClass("positive").removeClass("negative").removeClass("visible"),t.flag(a,"unverified",!0),t.$obj.parent().trigger("--refresh-scrollbar"),"_form_verifyTimeout"in this&&window.clearTimeout(this._form_verifyTimeout),t.options.verify[n]("abort"),this._form_verifyTimeout=window.setTimeout((function(){if("1"!=a.data("invalid")&&""!=o&&(o=a.val(),"1"!=a.data("invalid")&&""!=o)){if(t.flag(a,"verifailed",!1),o==a.data("verify-originalValue"))return t.flag(a,"unverified",!1),void t.validate(a);s.text("Checking ...").addClass("visible").addClass("pending"),t.$obj.parent().trigger("--refresh-scrollbar"),t.options.verify[n]("verify",o,(function(e,i,r){e?(t.flag(a,"unverified",!1),t.validate(a),t.flag(a,"verifailed",!1),a.is(":focus")||a.trigger("change",["form.init.verified"]),"change"in t.options.fields[n]&&t.options.fields[n].change(o),s.removeClass("pending").removeClass("negative").removeClass("caution").removeClass("premium").addClass(r||"positive").html(i)):(t.flag(a,"unverified",!0),t.validate(a),t.flag(a,"verifailed",!0),a.is(":focus")||a.trigger("change",["form.init.unverified"]),"change"in t.options.fields[n]&&t.options.fields[n].change(""),s.removeClass("pending").removeClass("negative").removeClass("caution").removeClass("premium").addClass(r||"negative").html(i))}))}}),500))})),this.options.verify)i=(a=this.$obj.find('input[name="'+e+'"]')).parent(),0!=a.length&&$('<div class="message"></div>').insertAfter(i.hasClass("input-wrapper")?i:a);this.$obj.triggerHandler("--refresh-verify")}this.$obj.attr("action")&&this.$obj.data("action",this.$obj.attr("action")).removeAttr("action"),this.$obj.on("change","input,select,textarea",(function(){var e,a=$(this),i=a.attr("name"),s=a.data("missing")||a.data("invalid")?"":a.val();i in t.options.fields&&"trim"in t.options.fields[i]&&1==t.options.fields[i].trim&&(s=(s=(s=s.replace(/\t+/g," ")).replace(/ +/g," ")).trim(),a.val(s)),a.data("unverified")||"name"in t.options.fields&&("preprocess"in t.options.fields[i]&&(e=t.options.fields[i].preprocess(s))!=s&&(s=e,a.val(s)),"change"in t.options.fields[i]&&t.options.fields[i].change(s))})),this.$obj.on("submit",(function(e){var a=t.$obj.find("input,select,textarea");t.options.validation&&(a.each((function(){t.validate($(this))})),t.isValid()||(e.stopPropagation(),e.preventDefault())),t.options.submitHandler&&(e.stopPropagation(),e.preventDefault(),a.blur(),t.disableSubmits(!0),a.filter(":disabled").removeData("verify-originalValue"),t.clearAlert(),t.options.submitHandler((function(){t.enableSubmits()})))})),this.options.validation&&window.setTimeout((function(){t.$obj.find("input,select,textarea").each((function(){t.validate($(this))}))}),0)},$.fn.form=function(t){var e=$(this);if(0==this.length)return e;if(this.length>1){for(var a=0;a<this.length;a++)$(this[a]).form(t);return e}return"get"==e.attr("method")||"1"==e.data("ignore")||(this[0]._form=new i(e,t)),e},$.valHandlers.push({condition:function(){return this&&this.dataset&&void 0!==this.dataset.valueMap},init:function(){var t,e,a,i;if(!("_valueMap"in this))for(this._valueMap={},t=this.dataset.valueMap.split("&"),i=0;i<t.length;i++)1==(a=(e=t[i].split("="))[1].split("-")).length&&(a[1]=a[0]),a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),this._valueMap[e[0]]=a},get:function(t){var e,a;for(a in e=$.fn.origVal.call($(this)),this._valueMap)if(e>=this._valueMap[a][0]&&e<=this._valueMap[a][1])return a;return e},set:function(t){return $.fn.origVal.call($(this),t in this._valueMap?this._valueMap[t][0]:t)}}),$.valHandlers.push({condition:function(){return this&&this.dataset&&void 0!==this.dataset.suffixes},get:function(){var t,e,a=$(this),i=a.next("select");return(t=$.fn.origVal.call(a))?i.attr("name")?t:t+((e=$.fn.origVal.call(i))?","+e:""):""},set:function(t){var e,a,i,s=$(this),n=s.next("select");return null===t&&(t=""),n.attr("name")?($.fn.origVal.call(s,a),s):((e=t.split(",")).length>2||!e[0]&&e[1]||(1==e.length?""==e[0]?(a="",i=null):(a=e[0],i=""):(a=e[0],i=1==n.children('option[value="'+e[1]+'"]').length?e[1]:""),null!==i&&($.fn.origVal.call(n,i),n.triggerHandler("change",["form.valHandlers.suffixes"])),$.fn.origVal.call(s,a)),s)}}),$.fn.origVal=$.fn.val,$.fn.val=function(t){var e,a,i;if(0==this.length)return void 0!==t?$.fn.origVal.call(this,t):$.fn.origVal.call(this);if(void 0!==t){for(e=0;e<this.length;e++){for(a in i=!1,$.valHandlers)if($.valHandlers[a].condition.apply(this[e])){"init"in $.valHandlers[a]&&$.valHandlers[a].init.call(this[e]),$.valHandlers[a].set.call(this[e],t),i=!0;break}i||$.fn.origVal.call($(this[e]),t)}return this}for(a in $.valHandlers)if($.valHandlers[a].condition.apply(this[0]))return"init"in $.valHandlers[a]&&$.valHandlers[a].init.call(this[0]),$.valHandlers[a].get.call(this[0]);return $.fn.origVal.call(this)}},{"./formArray.js":"formArray","./formColorPicker.js":"formColorPicker","./formImageUploader.js":"formImageUploader","./formList.js":2,"./formVideoUploader.js":"formVideoUploader"}],tabs:[function(t,e,a){function i(t,e){var a=this,i=$('<ul class="tabs'+(e?" depth-"+e:"")+'"></ul>').prependTo(t);void 0===e&&(e=0),this.tabs=[],this.$tabs=$(),this.$panes=$(),t.children("section[data-title]").each((function(t){var s={$tab:null,$pane:null,title:null};s.$pane=$(this),s.$pane.hide(),a.$panes=a.$panes.add(s.$pane),s.$pane.children("section[data-title]").length>0&&s.$pane.tabs(e+1),s.title=s.$pane.data("title"),s.$tab=$('<li tabindex="0">'+s.title+"</li>").appendTo(i),s.$tab.on("blur",(function(t){$(this).removeClass("is-clicked")})).on("mousedown",(function(t){$(this).addClass("is-clicked")})).on("click",(function(){a.switch(t)})).on("keydown",(function(t){switch(t.keyCode){case 13:case 32:t.preventDefault(),t.stopPropagation(),$(this).trigger("click");break;default:return app.keyHandler.apply(this,[t])}})),a.$tabs=a.$tabs.add(s.$tab),a.tabs.push(s)})),this.switch(0)}e.exports=i,i.prototype.switch=function(t){var e=this.tabs[t];this.$tabs.removeClass("active"),this.$panes.css("display","none"),e.$tab.addClass("active"),e.$pane.css("display","")},$.fn.tabs=function(t){var e=$(this);if(0==this.length)return e;if(this.length>1){for(var a=0;a<this.length;a++)$(this[a]).tabs(t);return e}return this[0]._tabs=new i(e,t),e}},{}]},{},[1]);